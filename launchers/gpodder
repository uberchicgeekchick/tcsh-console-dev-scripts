#!/bin/tcsh -f
set this_program="`basename '${0}'`";
#set program=/usr/bin/${this_program};
foreach program ( "`where '${this_program}'`" )
	#printf "Checking [%s] against [%s]\n" "${program}" "${this_program}";
	if( "${program}" != "${0}" && -x "${program}" ) break
end

if(!( ${?program} && -x "${program}" )) then
	printf "Unable to find %s.\n", "${this_program}";
	exit -1;
endif

if(! ${?eol} ) setenv eol '$';

set argz="";
next_argv:
while( ${?1} && "${1}" != "" )
	set message="";
	set action="`printf "\""${1}"\"" | sed 's/\-\-\([^=]\+\)=\?\(.*\)${eol}/\1/'`";
	set feed="`printf "\""${1}"\"" | sed 's/\-\-\([^=]\+\)=\?\(.*\)${eol}/\2/'`";
	switch( "${action}" )
	case "debug":
		set tcshrc_debug_set;
		set TCSHRC_DEBUG;
		shift
		continue
		breaksw
	case "add":
		if( "${message}" == "" ) set message="add";
	case "del":
		if( "${message}" == "" ) set message="delete";
		set argz=--${action}="${feed}";
		breaksw
	default:
		set argz=${1};
		breaksw
	endsw
	shift
	goto run_progie
end

if(! ${?gpodder_ran} ) then
	set gpodder_run_once message feed argz;
	goto run_progie;
endif

if( ${?gpodder_run_once} ) unset gpodder_run_once
if( ${?tcshrc_debug_set} ) then
	unset tcshrc_debug_set;
	unsetenv TCSHRC_DEBUG;
endif

unset this_program program gpodder_ran message feed argz;

exit;

run_progie:
set gpodder_ran
if( "${message}" != "" && "${feed}" != "" ) printf "Attempting to %s:\n\t<%s>\n" "${message}" "${feed}";
if( ${?TCSHRC_DEBUG} ) echo "Running:\n"\ \( ${program} "${argz}" \> /dev/tty \) \>\& /dev/null
if( ! ${?OUTPUT_STDERR} ) then
	( ${program} "${argz}" > /dev/tty ) >& /dev/null
else
	${program} "${argz}" >& /dev/null
endif
if(! ${?gpodder_run_once} ) goto next_argv

