<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<title>Common Practices (Programming Perl)</title>

<!-- STYLESHEET -->

<link rel="stylesheet" type="text/css" href="../style/style1.css">

<!-- METADATA -->



<!--Dublin Core Metadata-->

<meta name="DC.Creator" content="">
<meta name="DC.Date" content="">
<meta name="DC.Format" content="text/xml" scheme="MIME">
<meta name="DC.Generator" content="XSLT stylesheet, xt by James Clark">
<meta name="DC.Identifier" content="">
<meta name="DC.Language" content="en-US">
<meta name="DC.Publisher" content="O'Reilly &amp; Associates, Inc.">
<meta name="DC.Source" content="" scheme="ISBN">
<meta name="DC.Subject.Keyword" content="">
<meta name="DC.Title" content="Common Practices">
<meta name="DC.Type" content="Text.Monograph">

</head>

<body>
</div>
<style type="text/css">
  #fixunixgb { position: absolute; right: 0px; bottom: 0px; }
  div > div#fixunixgb { position: fixed; }
  pre.fixit { overflow:auto;border-left:1px dashed #000;border-right:1px dashed #000;padding-left:2px; }
</style><!--[if gte IE 5.5]><![if lt IE 7]>
<style type="text/css">
  div#fixunixgb {
  right: auto; bottom: auto;
  left: expression( ( 0 - fixunixgb.offsetWidth + ( document.documentElement.clientWidth ? document.documentElement.clientWidth : document.body.clientWidth ) + ( ignoreMe2 = document.documentElement.scrollLeft ? document.documentElement.scrollLeft : document.body.scrollLeft ) ) + 'px' );
  top: expression( ( 0 - fixunixgb.offsetHeight + ( document.documentElement.clientHeight ? document.documentElement.clientHeight : document.body.clientHeight ) + ( ignoreMe = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop ) ) + 'px' );
}
</style>
<![endif]><![endif]-->
<div id="fixunixgb" align=right style="position:fixed; bottom: 5; right: 5; color:black; background-color: white; width: 170px; height: 120px; padding: 5px; z-index:3">
<script language="javascript">
<!--
var state = 'visible';

function gushowhide(layer_ref) {

if (state == 'visible') {
state = 'hidden';
}
else {
state = 'visible';
}
if (document.all) { //IS IE 4 or 5 (or 6 beta)
eval( "document.all." + layer_ref + ".style.visibility = state");
}
if (document.layers) { //IS NETSCAPE 4 or below
document.layers[layer_ref].visibility = state;
}
if (document.getElementById && !document.all) {
maxwell_smart = document.getElementById(layer_ref);
maxwell_smart.style.visibility = state;
}
}
//-->
</script>
<script type="text/javascript"><!--
google_ad_client = "pub-0321943928525350";
/* 160x90, bottomleft fixed */
google_ad_slot = "2032737097";
google_ad_width = 160;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<font size=-1><a href="javascript://" onclick="gushowhide('fixunixgb');">close (x)</a></font>
</div>
</div>
<br>
<center>

<script type="text/javascript"><!--
google_ad_client = "pub-0321943928525350";
//728x90, создано 30.01.08 (main top)
google_ad_slot = "2783893649";
google_ad_width = 728;
google_ad_height = 90;
//--></script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>

&nbsp; &nbsp; &nbsp; &nbsp;

<a href="http://www.internetmap.info/cgi-bin/go.cgi?site_id=49589" target=_blank><img src="http://www.internetmap.info/images/im_88x85.gif" border=0 alt="Internet Map"></a>
<br>

<b><a href="http://www.unix.org.ua/forum/">Do not forget register in our new UNIX and CISCO forum</a></b>

</center>
<p>


<html>
<head>
<title>Common Practices (Programming Perl)</title>

<!-- STYLESHEET -->

<link rel="stylesheet" type="text/css" href="../style/style1.css">

<!-- METADATA -->



<!--Dublin Core Metadata-->

<meta name="DC.Creator" content="">
<meta name="DC.Date" content="">
<meta name="DC.Format" content="text/xml" scheme="MIME">
<meta name="DC.Generator" content="XSLT stylesheet, xt by James Clark">
<meta name="DC.Identifier" content="">
<meta name="DC.Language" content="en-US">
<meta name="DC.Publisher" content="O'Reilly &amp; Associates, Inc.">
<meta name="DC.Source" content="" scheme="ISBN">
<meta name="DC.Subject.Keyword" content="">
<meta name="DC.Title" content="Common Practices">
<meta name="DC.Type" content="Text.Monograph">

</head>

<body>

<!-- START OF BODY -->



<!-- TOP BANNER -->

<img src="gifs/smbanner.gif" usemap="#banner-map" border="0" alt="Book Home">
<map name="banner-map"><AREA SHAPE="RECT" COORDS="0,0,466,71" HREF="index.htm" ALT="Programming Perl"><AREA SHAPE="RECT" COORDS="467,0,514,18" HREF="jobjects/fsearch.htm" ALT="Search this book">
</map>

<!-- TOP NAV BAR -->

<div class="navbar">
<table width="515" border="0">
<tr>
<td align="left" valign="top" width="172"><a href="ch23_03.htm"><img src="../gifs/txtpreva.gif" alt="Previous" border="0"></a></td><td align="center" valign="top" width="171"><a href="part4.htm">Part 4: Perl as Culture</a></td><td align="right" valign="top" width="172"><a href="ch24_02.htm"><img src="../gifs/txtnexta.gif" alt="Next" border="0"></a></td>
</tr>
</table>
</div>
<hr width="515" align="left">

<!-- SECTION BODY -->
<h1 class="chapter">Chapter 24.  Common Practices</h1>
<div class="htmltoc">
<h4 class="tochead">Contents:</h4>
<p>
<a href="ch24_01.htm">Common Goofs for Novices</a>
<br>
<a href="ch24_02.htm">Efficiency</a>
<br>
<a href="ch24_03.htm">Programming with Style</a>
<br>
<a href="ch24_04.htm">Fluent Perl</a>
<br>
<a href="ch24_05.htm">Program Generation</a>
<br>
</p>
</div>

<a name="INDEX-4096"></a><a name="INDEX-4097"></a>
<p>Ask almost any Perl programmer, and they'll be glad to give you reams
of advice on how to program.  We're no different (in case you hadn't
noticed).  In this chapter, rather than trying to tell you about
specific features of Perl, we'll go at it from the other direction and
use a more scattergun approach to describe idiomatic Perl.  Our hope is
that, by putting together various bits of things that seemingly aren't
related, you can soak up some of the feeling of what it's like to
actually "think Perl".  After all, when you're programming, you don't
write a bunch of expressions, then a bunch of subroutines, then a bunch
of objects.  You have to go at everything all at once, more or less.
So this chapter is a bit like that.</p>

<p>There is, however, a rudimentary organization to the chapter, in that
we'll start with the negative advice and work our way towards the positive
advice.  We don't know if that will make you feel any better, but it makes
us feel better.</p>


<h2 class="sect1">24.1. Common Goofs for Novices</h2>

<p>
<a name="INDEX-4098"></a><a name="INDEX-4099"></a><a name="INDEX-4100"></a><a name="INDEX-4101"></a><a name="INDEX-4102"></a>
The biggest goof of all is forgetting to <tt class="literal">use
warnings</tt>, which identifies many errors.  The second biggest
goof is forgetting to <tt class="literal">use strict</tt> when it's
appropriate.  These two pragmas can save you hours of head-banging
when your program starts getting bigger.  (And it will.)  Yet another
faux pas is to forget to consult the online FAQ.  Suppose you want to
find out if Perl has a <tt class="literal">round</tt> function.  You might
try searching the FAQ first:
<blockquote>
<pre class="programlisting">% <tt class="userinput"><b>perlfaq round</b></tt>
</pre>
</blockquote>

Apart from those "metagoofs", there are several kinds of programming
traps.  Some traps almost everyone falls into, and other traps you'll
fall into only if you come from a particular culture that does things
differently.  We've separated these out in the following sections.</p>


<h3 class="sect2">24.1.1. Universal Blunders</h3>

<ul>
<li>
<p>
<a name="INDEX-4103"></a><a name="INDEX-4104"></a>
Putting a comma after the filehandle in a <tt class="literal">print</tt>
statement. Although it looks extremely regular and pretty to say:
<blockquote>
<pre class="programlisting">print STDOUT, "goodbye", $adj, "world!\n";    # WRONG</pre>
</blockquote>

this is nonetheless incorrect, because of that first comma.  What you
want instead is the indirect object syntax:
<blockquote>
<pre class="programlisting">print STDOUT "goodbye", $adj, "world!\n";     # ok</pre>
</blockquote>

The syntax works this way so that you can say:
<blockquote>
<pre class="programlisting">print $filehandle "goodbye", $adj, "world!\n";</pre>
</blockquote>

where <tt class="literal">$filehandle</tt> is a scalar holding the name of a
filehandle at run time.  This is distinct from:
<blockquote>
<pre class="programlisting">print $notafilehandle, "goodbye", $adj, "world!\n";</pre>
</blockquote>

where <tt class="literal">$notafilehandle</tt> is simply a string that is
part of the list of things to be printed.  See "indirect object" in
the Glossary.</p>
</li>
<li>
<p>
<a name="INDEX-4105"></a><a name="INDEX-4106"></a><a name="INDEX-4107"></a><a name="INDEX-4108"></a><a name="INDEX-4109"></a><a name="INDEX-4110"></a>
Using <tt class="literal">==</tt> instead of <tt class="literal">eq</tt> and
<tt class="literal">!=</tt> instead of <tt class="literal">ne</tt>.  The
<tt class="literal">==</tt> and <tt class="literal">!=</tt> operators are
<em class="emphasis">numeric</em> tests.  The other two are
<em class="emphasis">string</em> tests.  The strings
<tt class="literal">"123"</tt> and <tt class="literal">"123.00"</tt> are equal as
numbers, but not equal as strings.  Also, any nonnumeric string is
numerically equal to zero.  Unless you are dealing with numbers, you
almost always want the string comparison operators instead.</p>
</li>
<li>
<p>
<a name="INDEX-4111"></a>
Forgetting the trailing semicolon. Every statement in Perl is
terminated by a semicolon or the end of a block.  Newlines aren't
statement terminators as they are in <em class="emphasis">awk</em>, Python,
or FORTRAN.  Remember that Perl is like C.</p>

<p>
<a name="INDEX-4112"></a>
A statement containing a here document is particularly prone to losing
its semicolon.  It ought to look like this:
<blockquote>
<pre class="programlisting">print &lt;&lt;'FINIS';
A foolish consistency is the hobgoblin of little minds,
adored by little statesmen and philosophers and divines.
                                       --Ralph Waldo Emerson
FINIS</pre>
</blockquote>
</p>
</li>
<li>
<p>
<a name="INDEX-4113"></a>
Forgetting that a <em class="replaceable">BLOCK</em> requires braces.  Naked statements are not
<em class="replaceable">BLOCK</em>s.  If you are creating a control structure such as a <tt class="literal">while</tt>
or an <tt class="literal">if</tt> that requires one or more <em class="replaceable">BLOCK</em>s, you <em class="emphasis">must</em> use braces
around each <em class="replaceable">BLOCK</em>.  Remember that Perl is <em class="emphasis">not</em> like C.</p>
</li>
<li>
<p>
<a name="INDEX-4114"></a><a name="INDEX-4115"></a><a name="INDEX-4116"></a><a name="INDEX-4117"></a><a name="INDEX-4118"></a>
Not saving <tt class="literal">$1</tt>, <tt class="literal">$2</tt>, and so on, across regular
expressions. Remember that every new <tt class="literal">m/atch/</tt> or <tt class="literal">s/ubsti/tution/</tt>
will set (or clear, or mangle) your <tt class="literal">$1</tt>, <tt class="literal">$2</tt>...variables, as well
as <tt class="literal">$`</tt>, <tt class="literal">$&amp;</tt>, and <tt class="literal">$'</tt>.  One way to save them right away is to
evaluate the match within a list context, as in:
<blockquote>
<pre class="programlisting">my ($one, $two) = /(\w+) (\w+)/;</pre>
</blockquote>
</p>
</li>
<li>
<p>
<a name="INDEX-4119"></a><a name="INDEX-4120"></a>
Not realizing that a <tt class="literal">local</tt> also changes the
variable's value as seen by other subroutines called within the scope
of the local.  It's easy to forget that <tt class="literal">local</tt> is a
run-time statement that does dynamic scoping, because there's no
equivalent in languages like C.  See the section "Scoped
Declarations" in
<a href="ch04_01.htm">Chapter 4, "Statements and Declarations"</a>.  Usually you want a
<tt class="literal">my</tt> anyway.</p>
</li>
<li>
<p>Losing track of brace pairings. A good text editor will help you find
the pairs.  Get one.  (Or two.)</p>
</li>
<li>
<p>
<a name="INDEX-4121"></a><a name="INDEX-4122"></a> Using loop control
statements in <tt class="literal">do {} while</tt>. Although the braces in
this control structure look suspiciously like part of a loop
<em class="replaceable">BLOCK</em>, they aren't.</p>
</li>
<li>
<p> Saying <tt class="literal">@foo[1]</tt> when you mean
<tt class="literal">$foo[1]</tt>. The <tt class="literal">@foo[1]</tt> reference
is an array <em class="emphasis">slice</em>, meaning an array consisting of
the single element <tt class="literal">$foo[1]</tt>. Sometimes this doesn't
make any difference, as in:
<blockquote>
<pre class="programlisting">print "the answer is @foo[1]\n";</pre>
</blockquote>

but it makes a big difference for things like:
<blockquote>
<pre class="programlisting">@foo[1] = &lt;STDIN&gt;;</pre>
</blockquote>

which will slurp up all the rest of <tt class="literal">STDIN</tt>, assign
the <em class="emphasis">first</em> line to <tt class="literal">$foo[1]</tt>, and
discard everything else. This is probably not what you intended.  Get
into the habit of thinking that <tt class="literal">$</tt> means a single
value, while <tt class="literal">@</tt> means a list of values, and you'll
do okay.</p>
</li>
<li>
<p>
<a name="INDEX-4123"></a>
Forgetting the parentheses of a list operator like <tt class="literal">my</tt>:
<blockquote>
<pre class="programlisting">my  $x, $y  = (4, 8);     # WRONG 
my ($x, $y) = (4, 8);     # ok</pre>
</blockquote>
</p>
</li>
<li>
<p>
<a name="INDEX-4124"></a>
Forgetting to select the right filehandle before setting
<tt class="literal">$^</tt>, <tt class="literal">$~</tt>, or
<tt class="literal">$|</tt>.  These variables depend on the currently
selected filehandle, as determined by
<tt class="literal">select(</tt><em class="replaceable">FILEHANDLE</em><tt class="literal">)</tt>. The
initial filehandle so selected is <tt class="literal">STDOUT</tt>.  You
should really be using the filehandle methods from the
<tt class="literal">FileHandle</tt> module instead.  See <a href="ch28_01.htm">Chapter 28, "Special Names"</a>.</p>
</li>
</ul>






<h3 class="sect2">24.1.2. Frequently Ignored Advice</h3>

<p>Practicing Perl Programmers should take note of the following:</p>

<ul>
<li>
<p>
<a name="INDEX-4125"></a><a name="INDEX-4126"></a>
Remember that many operations behave differently in a list context than
they do in a scalar one.  For instance:
<blockquote>
<pre class="programlisting">($x) = (4, 5, 6);        # List context; $x is set to 4
 $x  = (4, 5, 6);        # Scalar context; $x is set to 6

 @a  = (4, 5, 6);        
 $x  = @a;               # Scalar context; $x is set to 3 (the array list)</pre>
</blockquote>
</p>
</li>
<li>
<p>
<a name="INDEX-4127"></a><a name="INDEX-4128"></a>
Avoid barewords if you can, especially all lowercase ones. You can't
tell just by looking at it whether a word is a function or a bareword
string.  By using quotes on strings and parentheses around function
call arguments, you won't ever get them confused. In fact, the pragma
<tt class="literal">use strict</tt> at the beginning of your program makes
barewords a compile-time error--probably a good thing.</p>
</li>
<li>
<p> You can't tell just by looking
which built-in functions are unary operators (like
<tt class="literal">chop</tt> and <tt class="literal">chdir</tt>), which are list
operators (like <tt class="literal">print</tt> and
<tt class="literal">unlink</tt>), and which are argumentless (like
<tt class="literal">time</tt>).  You'll want to learn them by reading <a href="ch29_01.htm">Chapter 29, "Functions"</a>. As always, use parentheses if you
aren't sure--or even if you aren't sure you're sure.  Note also that
user-defined subroutines are by default list operators, but they can
be declared as unary operators with a prototype of
<tt class="literal">($)</tt> or argumentless with a prototype of
<tt class="literal">()</tt>.</p>
</li>
<li>
<p> People
have a hard time remembering that some functions default to
<tt class="literal">$_</tt>, or <tt class="literal">@ARGV</tt>, or
whatever, while others do not.  Take the time to learn which are
which, or avoid default arguments.</p>
</li>
<li>
<p>
<a name="INDEX-4129"></a><a name="INDEX-4130"></a><tt class="literal">&lt;FH&gt;</tt> is not the name of a filehandle, but an
angle operator that does a line-input operation on the handle.  This
confusion usually manifests itself when people try to
<tt class="literal">print</tt> to the angle operator:
<blockquote>
<pre class="programlisting">print &lt;FH&gt; "hi";    # WRONG, omit angles</pre>
</blockquote>
</p>
</li>
<li>
<p>Remember also that data read by the angle operator is assigned to
<tt class="literal">$_</tt> only when the file read is the sole condition in
a <tt class="literal">while</tt> loop:
<blockquote>
<pre class="programlisting">while (&lt;FH&gt;) { }   # Data assigned to $_.
&lt;FH&gt;;              # Data read and discarded!</pre>
</blockquote>
</p>
</li>
<li>
<p>Don't use <tt class="literal">=</tt> when you need <tt class="literal">=~</tt>;
the two constructs are quite different:
<blockquote>
<pre class="programlisting">$x =  /foo/;  # Searches $_ for "foo", puts result in $x
$x =~ /foo/;  # Searches $x for "foo", discards result</pre>
</blockquote>
</p>
</li>
<li>
<p>
<a name="INDEX-4131"></a><a name="INDEX-4132"></a><a name="INDEX-4133"></a><a name="INDEX-4134"></a>
Use <tt class="literal">my</tt> for local variables whenever you can get
away with it. Using <tt class="literal">local</tt> merely gives a temporary
value to a global variable, which leaves you open to unforeseen side
effects of dynamic scoping.</p>
</li>
<li>
<p>Don't use <tt class="literal">local</tt> on a module's exported variables.
If you localize an exported variable, its exported value will not
change.  The local name becomes an alias to a new value but the
external name is still an alias for the original.</p>
</li>
</ul>






<h3 class="sect2">24.1.3. C Traps</h3>

<p>
<a name="INDEX-4135"></a><a name="INDEX-4136"></a>
Cerebral C programmers should take note of the following:</p>

<ul>
<li>
<p>Curlies are required for <tt class="literal">if</tt> and <tt class="literal">while</tt> blocks.</p>
</li>
<li>
<p>
<a name="INDEX-4137"></a>
You must use <tt class="literal">elsif</tt> rather than "else if" or
"elif".  Syntax like this:
<blockquote>
<pre class="programlisting">if (expression) {
    block;
}
else if (another_expression) {      # WRONG
    another_block;
}</pre>
</blockquote>

is illegal.  The <tt class="literal">else</tt> part is always a block, and a
naked <tt class="literal">if</tt> is not a block. You mustn't expect Perl to
be exactly the same as C.  What you want instead is:
<blockquote>
<pre class="programlisting">if (expression) {
    block;
}
elsif (another_expression) {
    another_block;
}</pre>
</blockquote>

Note also that "elif" is "file" spelled backward.  Only
Algol-ers would want a keyword that was the same as another word
spelled backward.</p>
</li>
<li>
<p>
<a name="INDEX-4138"></a><a name="INDEX-4139"></a>
The <tt class="literal">break</tt> and <tt class="literal">continue</tt> keywords
from C become in Perl <tt class="literal">last</tt> and
<tt class="literal">next</tt>, respectively. Unlike in C, these do
<em class="emphasis">not</em> work within a <tt class="literal">do {} while</tt>
construct.
<a name="INDEX-4140"></a><a name="INDEX-4141"></a>
</p>
</li>
<li>
<p>
<a name="INDEX-4142"></a>
There's no switch statement.  (But it's easy to build one on the fly;
see "Bare Blocks" and "Case Structures" in <a href="ch04_01.htm">Chapter 4, "Statements and Declarations"</a>.)</p>
</li>
<li>
<p>
<a name="INDEX-4143"></a>
Variables begin with <tt class="literal">$</tt>, <tt class="literal">@</tt>, or <tt class="literal">%</tt> in Perl.</p>
</li>
<li>
<p>
<a name="INDEX-4144"></a>
Comments begin with <tt class="literal">#</tt>, not <tt class="literal">/*</tt>.</p>
</li>
<li>
<p>
<a name="INDEX-4145"></a>
You can't take the address of anything, although a similar operator in
Perl is the backslash, which creates a reference.</p>
</li>
<li>
<p>
<tt class="literal">ARGV</tt> must be
capitalized. <tt class="literal">$ARGV[0]</tt> is C's
<tt class="literal">argv[1]</tt>, and C's <tt class="literal">argv[0]</tt> ends up
in <tt class="literal">$0</tt>.
<a name="INDEX-4146"></a>
</p>
</li>
<li>
<p>
<a name="INDEX-4147"></a>
Syscalls such as <tt class="literal">link</tt>, <tt class="literal">unlink</tt>,
and <tt class="literal">rename</tt> return true for success, not
<tt class="literal">0</tt>.</p>
</li>
<li>
<p>
<a name="INDEX-4148"></a>
The signal handlers in <tt class="literal">%SIG</tt> deal with signal names,
not numbers.</p>
</li>
</ul>






<h3 class="sect2">24.1.4. Shell Traps</h3>

<p>
<a name="INDEX-4149"></a><a name="INDEX-4150"></a>
Sharp shell programmers should take note of the following:</p>

<ul>
<li>
<p>
<a name="INDEX-4151"></a>
Variables are prefixed with <tt class="literal">$</tt>,
<tt class="literal">@</tt>, or <tt class="literal">%</tt> on the left side of the
assignment as well as the right.  A shellish assignment like:
<blockquote>
<pre class="programlisting">camel='dromedary';      # WRONG</pre>
</blockquote>

won't be parsed the way you expect.  You need:
<blockquote>
<pre class="programlisting">$camel='dromedary';     # ok</pre>
</blockquote>
</p>
</li>
<li>
<p>
<a name="INDEX-4152"></a>
The loop variable of a <tt class="literal">foreach</tt> also requires a <tt class="literal">$</tt>. Although <em class="emphasis">csh</em>
likes:
<blockquote>
<pre class="programlisting">foreach hump (one two)
    stuff_it $hump
end</pre>
</blockquote>

in Perl, this is written as:
<blockquote>
<pre class="programlisting">foreach $hump ("one", "two") {
    stuff_it($hump);
}</pre>
</blockquote>
</p>
</li>
<li>
<p>
<a name="INDEX-4153"></a>
The backtick operator does variable interpolation without regard to the
presence of single quotes in the command.</p>
</li>
<li>
<p>The backtick operator does no translation of the return value. In Perl,
you have to trim the newline explicitly, like this:
<blockquote>
<pre class="programlisting">chomp($thishost = `hostname`);</pre>
</blockquote>
</p>
</li>
<li>
<p>
<a name="INDEX-4154"></a>
Shells (especially <em class="emphasis">csh</em>) do several levels of substitution on each
command line.  Perl does interpolation only within certain constructs
such as double quotes, backticks, angle brackets, and search patterns.</p>
</li>
<li>
<p>Shells tend to interpret scripts a little bit at a time.  Perl compiles
the entire program before executing it (except for <tt class="literal">BEGIN</tt> blocks,
which execute before the compilation is done).
<a name="INDEX-4155"></a>
</p>
</li>
<li>
<p>
<a name="INDEX-4156"></a>
Program arguments are available via <tt class="literal">@ARGV</tt>, not
<tt class="literal">$1</tt>, <tt class="literal">$2</tt>, and so on.</p>
</li>
<li>
<p>The environment is not automatically made available as individual scalar
variables.  Use the standard <tt class="literal">Env</tt> module if you want that to happen.
<a name="INDEX-4157"></a>
</p>
</li>
</ul>






<h3 class="sect2">24.1.5. Previous Perl Traps</h3>

<p>
<a name="INDEX-4158"></a><a name="INDEX-4159"></a>
Penitent Perl 4 (and Prior) Programmers should take note of the
following changes between release 4 and release 5 that might affect old
scripts:</p>

<ul>
<li>
<p>
<a name="INDEX-4160"></a><tt class="literal">@</tt> now always interpolates an array in double-quotish strings. Some
programs may now need to use backslashes to protect any <tt class="literal">@</tt> that
shouldn't interpolate.</p>
</li>
<li>
<p>
<a name="INDEX-4161"></a><a name="INDEX-4162"></a>
Barewords that used to look like strings to Perl will now look like
subroutine calls if a subroutine by that name is defined before the
compiler sees them.  For example:
<blockquote>
<pre class="programlisting">sub SeeYa { die "Hasta la vista, baby!" }
$SIG{'QUIT'} = SeeYa;</pre>
</blockquote>

In prior versions of Perl, that code would set the signal handler.  Now,
it actually calls the function!  You may use the <span class="option">-w</span> switch to find
such risky usage or <tt class="literal">use strict</tt> to outlaw it.</p>
</li>
<li>
<p>
<a name="INDEX-4163"></a><a name="INDEX-4164"></a>
Identifiers starting with "<tt class="literal">_</tt>" are no longer forced
into package <tt class="literal">main</tt>, except for the bare underscore
itself (as in <tt class="literal">$_</tt>, <tt class="literal">@_</tt>, and so on).</p>
</li>
<li>
<p>
<a name="INDEX-4165"></a>
A double colon is now a valid package separator in an identifier.  Thus,
the statement:
<blockquote>
<pre class="programlisting">print "$a::$b::$c\n";</pre>
</blockquote>

now parses <tt class="literal">$a::</tt> as the variable reference, where in
prior versions only the <tt class="literal">$a</tt> was considered to be the
variable reference.  Similarly:
<blockquote>
<pre class="programlisting">print "$var::abc::xyz\n";</pre>
</blockquote>

is now interpreted as a single variable
<tt class="literal">$var::abc::xyz</tt>, whereas in prior versions, the
variable <tt class="literal">$var</tt> would have been followed by the
constant text <tt class="literal">::abc::xyz</tt>.</p>
</li>
<li>
<p>
<tt class="literal">s'$pattern'replacement'</tt> now performs no interpolation on
<tt class="literal">$pattern</tt>.  (The <tt class="literal">$</tt> would be
interpreted as an end-of-line assertion.) This behavior occurs only
when using single quotes as the substitution delimiter; in other
substitutions, <tt class="literal">$pattern</tt> is always interpolated.
<a name="INDEX-4166"></a>
</p>
</li>
<li>
<p>
<a name="INDEX-4167"></a>
The second and third arguments of <tt class="literal">splice</tt> are now
evaluated in scalar context rather than in list context.</p>
</li>
<li>
<p>
<a name="INDEX-4168"></a>
These are now semantic errors because of precedence:
<blockquote>
<pre class="programlisting">shift @list + 20;    # Now parses like shift(@list + 20), illegal!
$n = keys %map + 20; # Now parses like keys(%map + 20), illegal!</pre>
</blockquote>

Because if those were to work, then this couldn't:
<blockquote>
<pre class="programlisting">sleep $dormancy + 20;</pre>
</blockquote>
</p>
</li>
<li>
<p>
<a name="INDEX-4169"></a>
The precedence of assignment operators is now the same as the precedence
of assignment.  Previous versions of Perl mistakenly gave them the
precedence of the associated operator.  So you now must parenthesize
them in expressions like:
<blockquote>
<pre class="programlisting">/foo/ ? ($a += 2) : ($a -= 2);</pre>
</blockquote>

Otherwise:
<blockquote>
<pre class="programlisting">/foo/ ? $a += 2 : $a -= 2;</pre>
</blockquote>

would be erroneously parsed as:
<blockquote>
<pre class="programlisting">(/foo/ ? $a += 2 : $a) -= 2;</pre>
</blockquote>

On the other hand:
<blockquote>
<pre class="programlisting">$a += /foo/ ? 1 : 2;</pre>
</blockquote>

now works as a C programmer would expect.</p>
</li>
<li>
<p>
<tt class="literal">open FOO || die</tt> is incorrect.  You need parentheses around the
filehandle, because <tt class="literal">open</tt> has the precedence of a list operator.</p>
</li>
<li>
<p>
<a name="INDEX-4170"></a>
The elements of argument lists for formats are now evaluated in list
context.  This means you can interpolate list values now.</p>
</li>
<li>
<p>You can't do a <tt class="literal">goto</tt> into a block that is optimized away.  Darn.</p>
</li>
<a name="INDEX-4171"></a>
<li>
<p>It is no longer legal to use whitespace as the name of a variable or
as a delimiter for any kind of quote construct. Double darn.
<a name="INDEX-4172"></a>
</p>
</li>
<li>
<p>
<a name="INDEX-4173"></a>
The <tt class="literal">caller</tt> function now returns a false value in scalar context
if there is no caller.  This lets modules determine whether they're
being required or run directly.</p>
</li>
<li>
<p>
<tt class="literal">m//g</tt> now attaches its state to the searched string rather than the
regular expression.  See <a href="ch05_01.htm">Chapter 5, "Pattern Matching"</a>, for further
details.
<a name="INDEX-4174"></a>
</p>
</li>
<li>
<p>
<tt class="literal">reverse</tt> is no longer allowed as the name of a <tt class="literal">sort</tt> subroutine.
<a name="INDEX-4175"></a><a name="INDEX-4176"></a>
</p>
</li>
<li>
<p>
<a name="INDEX-4177"></a><em class="emphasis">taintperl</em> is no longer a separate executable.   There is now a <span class="option">-T</span>
switch to turn on tainting when it isn't turned on automatically.</p>
</li>
<li>
<p>
<a name="INDEX-4178"></a>
Double-quoted strings may no longer end with an unescaped <tt class="literal">$</tt> or <tt class="literal">@</tt>.</p>
</li>
<li>
<p>The archaic <tt class="literal">if</tt><em class="replaceable">BLOCK BLOCK</em> syntax is no longer supported.</p>
</li>
<li>
<p>Negative array subscripts now count from the end of the array.
<a name="INDEX-4179"></a><a name="INDEX-4180"></a>
</p>
</li>
<li>
<p>The comma operator in a scalar context is now guaranteed to give a
scalar context to its arguments.
<a name="INDEX-4181"></a><a name="INDEX-4182"></a>
</p>
</li>
<li>
<p>The <tt class="literal">**</tt> operator now binds more tightly than unary minus.</p>
</li>
<li>
<p>Setting <tt class="literal">$#array</tt> lower now discards array elements immediately.</p>
</li>
<li>
<p>
<tt class="literal">delete</tt> is not guaranteed to return the deleted value for <tt class="literal">tie</tt>d
arrays, since this capability may be onerous for some modules to
implement.
<a name="INDEX-4183"></a><a name="INDEX-4184"></a>
</p>
</li>
<li>
<p>The construct <tt class="literal">"this is $$x"</tt>, which used to interpolate the process
ID at that point, now tries to dereference <tt class="literal">$x</tt>.  <tt class="literal">$$</tt> by itself
still works fine, however.</p>
</li>
<li>
<p>
<a name="INDEX-4185"></a>
The behavior of <tt class="literal">foreach</tt> when it iterates over a
list that is not an array has changed slightly.  It used to assign the
list to a temporary array but now, for efficiency, no longer does so.
This means that you'll now be iterating over the actual values, not
copies of the values.  Modifications to the loop variable can change
the original values, even after the <tt class="literal">grep</tt>!
For instance:
<blockquote>
<pre class="programlisting">% <tt class="userinput"><b>perl4 -e '@a = (1,2,3); for (grep(/./, @a)) { $_++ }; print "@a\n"'</b></tt>
1 2 3
% <tt class="userinput"><b>perl5 -e '@a = (1,2,3); for (grep(/./, @a)) { $_++ }; print "@a\n"'</b></tt>
2 3 4</pre>
</blockquote>

To retain prior Perl semantics, you'd need to explicitly assign your list to a temporary array and then iterate over that.  For
example, you might need to change:
<blockquote>
<pre class="programlisting">foreach $var (grep /x/, @list) { ... }</pre>
</blockquote>

to:
<blockquote>
<pre class="programlisting">foreach $var (my @tmp = grep /x/, @list) { ... }</pre>
</blockquote>

Otherwise changing <tt class="literal">$var</tt> will clobber the values of <tt class="literal">@list</tt>.  (This
most often happens when you use <tt class="literal">$_</tt> for the loop variable and call
subroutines in the loop that don't properly localize <tt class="literal">$_</tt>.)</p>
</li>
<li>
<p>Some error messages and warnings will be different.</p>
</li>
<li>
<p>Some bugs may have been inadvertently removed.
<a name="INDEX-4186"></a><a name="INDEX-4187"></a>
</p>
</li>
</ul>
<a name="INDEX-4188"></a><a name="INDEX-4189"></a><a name="INDEX-4190"></a><a name="INDEX-4191"></a>














































<a name="INDEX-4308"></a><a name="INDEX-4309"></a>


<!-- BOTTOM NAV BAR -->

<hr width="515" align="left">
<div class="navbar">
<table width="515" border="0">
<tr>
<td align="left" valign="top" width="172"><a href="ch23_03.htm"><img src="../gifs/txtpreva.gif" alt="Previous" border="0"></a></td><td align="center" valign="top" width="171"><a href="index.htm"><img src="../gifs/txthome.gif" alt="Home" border="0"></a></td><td align="right" valign="top" width="172"><a href="ch24_02.htm"><img src="../gifs/txtnexta.gif" alt="Next" border="0"></a></td>
</tr>
<tr>
<td align="left" valign="top" width="172">23.3. Handling Insecure Code</td><td align="center" valign="top" width="171"><a href="index/index.htm"><img src="../gifs/index.gif" alt="Book Index" border="0"></a></td><td align="right" valign="top" width="172">24.2. Efficiency</td>
</tr>
</table>
</div>
<hr width="515" align="left">

<!-- LIBRARY NAV BAR -->

<img src="../gifs/smnavbar.gif" usemap="#library-map" border="0" alt="Library Navigation Links"><p>
<font size="-1"><a href="copyrght.htm">Copyright &copy; 2001</a> O'Reilly &amp; Associates. All rights reserved.</font>
</p>
<map name="library-map"> <area shape="rect" coords="2,-1,79,99" href="../index.htm"><area shape="rect" coords="84,1,157,108" href="../perlnut/index.htm"><area shape="rect" coords="162,2,248,125" href="../prog3/index.htm"><area shape="rect" coords="253,2,326,130" href="../advprog/index.htm"><area shape="rect" coords="332,1,407,112" href="../cookbook/index.htm"><area shape="rect" coords="414,2,523,103" href="../sysadmin/index.htm">
</map>

<!-- END OF BODY -->

</body>
</html>


<br>


<table border=0 align=center>
<tr><td>


<script type="text/javascript"><!--
google_ad_client = "pub-0321943928525350";
/* 468x60, main footer */
google_ad_slot = "1100896219";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>

<script>
user = "2823";
page = "2";

</script>



</td>
<td>

<!-- Ukrainian Banner Network 468x60 START -->
<center>
<script>
//<!--
user = "2823";
page = "2";
pid = Math.round((Math.random() * (10000000 - 1)));
document.write("<iframe src='http://banner.kiev.ua/cgi-bin/bi.cgi?h" +
user + "&amp;"+ pid + "&amp;" + page + "' frameborder=0 vspace=0 hspace=0 " +
" width=468 height=60 marginwidth=0 marginheight=0 scrolling=no>");
document.write("<a href='http://banner.kiev.ua/cgi-bin/bg.cgi?" +
user + "&amp;"+ pid + "&amp;" + page + "' target=_top>");
document.write("<img border=0 src='http://banner.kiev.ua/" +
"cgi-bin/bi.cgi?i" + user + "&amp;" + pid + "&amp;" + page +
"' width=468 height=60 alt='хЛТБЙОУЛБС вБООЕТОБС уЕФШ'></a>");
document.write("</iframe>");
//-->
</script>
</center>
<!-- Ukrainian Banner Network 468x60 END -->


</td></tr>
<tr><td colspan=2>
<br>
<hr size=1>



<!-- SpyLOG -->
<script src="http://tools.spylog.ru/counter_cv.js" id="spylog_code" type="text/javascript" counter="1028713" part="docs" track_links="ext" page_level="0">
</script>
<noscript>
<a href="http://u10287.13.spylog.com/cnt?cid=1028713&f=3&p=0" target="_blank">
<img src="http://u10287.13.spylog.com/cnt?cid=1028713&p=0" alt="SpyLOG" border="0" width="88" height="31"></a>
</noscript>
<!--/ SpyLOG -->

<!--bigmir)net TOP 100-->
<script type="text/javascript" language="javascript"><!--
function BM_Draw(oBM_STAT){
document.write('<table cellpadding="0" cellspacing="0" border="0" style="display:inline;margin-right:4px;"><tr><td><div style="margin:0px;padding:0px;font-size:1px;width:88px;"><div style="background:url(\'http://i.bigmir.net/cnt/samples/diagonal/b59_top.gif\') no-repeat bottom;">&nbsp;</div><div style="font:10px Tahoma;background:url(\'http://i.bigmir.net/cnt/samples/diagonal/b59_center.gif\');"><div style="text-align:center;"><a href="http://www.bigmir.net/" target="_blank" style="color:#0000ab;text-decoration:none;font:10px Tahoma;">bigmir<span style="color:#ff0000;">)</span>net</a></div><div style="margin-top:3px;padding: 0px 6px 0px 6px;color:#003596;"><div style="float:left;font:10px Tahoma;">'+oBM_STAT.hosts+'</div><div style="float:right;font:10px Tahoma;">'+oBM_STAT.hits+'</div></div><br clear="all"/></div><div style="background:url(\'http://i.bigmir.net/cnt/samples/diagonal/b59_bottom.gif\') no-repeat top;">&nbsp;</div></div></td></tr></table>');
}
//-->
</script>

<script type="text/javascript" language="javascript"><!--
bmN=navigator,bmD=document,bmD.cookie='b=b',i=0,bs=[],bm={o:1,v:126595,s:126595,t:0,c:bmD.cookie?1:0,n:Math.round((Math.random()* 1000000)),w:0};
for(var f=self;f!=f.parent;f=f.parent)bm.w++;
try{if(bmN.plugins&&bmN.mimeTypes.length&&(x=bmN.plugins['Shockwave Flash']))bm.m=parseInt(x.description.replace(/([a-zA-Z]|s)+/,''));
else for(var f=3;f<20;f++)if(eval('new ActiveXObject("ShockwaveFlash.ShockwaveFlash.'+f+'")'))bm.m=f}catch(e){;}
try{bm.y=bmN.javaEnabled()?1:0}catch(e){;}
try{bmS=screen;bm.v^=bm.d=bmS.colorDepth||bmS.pixelDepth;bm.v^=bm.r=bmS.width}catch(e){;}
r=bmD.referrer.slice(7);if(r&&r.split('/')[0]!=window.location.host){bm.f=escape(r);bm.v^=r.length}
bm.v^=window.location.href.length;for(var x in bm) if(/^[ovstcnwmydrf]$/.test(x)) bs[i++]=x+bm[x];
bmD.write('<sc'+'ript type="text/javascript" language="javascript" src="http://c.bigmir.net/?'+bs.join('&')+'"></sc'+'ript>');
//-->
</script>
<noscript>
<a href="http://www.bigmir.net/" target="_blank"><img src="http://c.bigmir.net/?v126595&s126595&t2" width="88" height="31" alt="bigmir)net TOP 100" title="bigmir)net TOP 100" border="0" /></a>
</noscript>
<!--bigmir)net TOP 100-->

<!--begin of Rambler's Top100 code -->
<a href="http://top100.rambler.ru/top100/">
<img src="http://counter.rambler.ru/top100.cnt?692798" alt="" width=1 height=1 border=0></a>
<!--end of Top100 code-->

<!--begin of Top100 logo-->
<a href="http://top100.rambler.ru/top100/">
<img src="http://top100-images.rambler.ru/top100/w1.gif" alt="Rambler's Top100" width=88 height=31 
border=0></a>
<!--end of Top100 logo -->


<!-- hit.ua -->
<a href='http://hit.ua/?x=3601' target='_blank'>
<script language="javascript" type="text/javascript"><!--
Cd=document;Cr="&"+Math.random();Cp="&s=1";
Cd.cookie="b=b";if(Cd.cookie)Cp+="&c=1";
Cp+="&t="+(new Date()).getTimezoneOffset();
if(self!=top)Cp+="&f=1";
//--></script>
<script language="javascript1.1" type="text/javascript"><!--
if(navigator.javaEnabled())Cp+="&j=1";
//--></script>
<script language="javascript1.2" type="text/javascript"><!--
if(typeof(screen)!='undefined')Cp+="&w="+screen.width+"&h="+
screen.height+"&d="+(screen.colorDepth?screen.colorDepth:screen.pixelDepth);
//--></script>
<script language="javascript" type="text/javascript"><!--
Cd.write("<img src='http://c.hit.ua/hit?i=3601&g=0&x=1"+Cp+Cr+
"&r="+escape(Cd.referrer)+"&u="+escape(window.location.href)+
"' border='0' width='88' height='31' "+
"alt='hit.ua: сейчас на сайте, посетителей и просмотров за сегодня' title='hit.ua: сейчас на сайте, посетителей и просмотров за сегодня'/>");
//--></script>
<noscript>
<img src='http://c.hit.ua/hit?i=3601&amp;g=0&amp;x=1' border='0' width='88' height='31' alt='hit.ua: сейчас на сайте, посетителей и просмотров за сегодня' title='hit.ua: сейчас на сайте, посетителей и просмотров за сегодня'/>
</noscript></a>
<!-- / hit.ua -->

<script language="javascript">//<!--
mtI="012408140822";mtG="45";mtT="4";mtS='http://012408140822.c.mystat-in.net/?';
mtD=document;mtN=navigator.appName;mtR=escape(mtD.referrer);
mtW="";mtC="";mtV="0";mtJ="1";
//--></script><script language="javascript1.1">//<!--
mtV="1";mtJ = (navigator.javaEnabled()?"1":"0");
//--></script><script language="javascript1.2">//<!--
mtE=screen;mtW=mtE.width;mtN!="Netscape"?mtC=mtE.colorDepth:mtC=mtE.pixelDepth;mtV="2";
//--></script><script language="javascript1.3">//<!--
mtV="3";
//--></script><script language="javascript">//<!--
mtUrl="";mtUrl+="\""+mtS+"i"+mtI+"&t"+mtT+"&g"+mtG+"&w"+mtW+"&c"+mtC+"&r"+mtR+"&v"+mtV+"&j"+mtJ+"\"";
mtUrl="<a href=http://mytop-in.net/ target=_blank><img src="+mtUrl+"width=88 height=31 border=0 alt=\"Rated by MyTOP\"></a>";
mtD.write(mtUrl);
//--></script>
<noscript>
<a href=http://mytop-in.net/ target=_blank><img src=http://012408140822.c.mystat-in.net/?i012408140822&t4&g45&j0 width=88 height=31 border=0 alt="Rated by MyTOP"></a>
</noscript>

<!--Rating@Mail.ru COUNTEr--><script language="JavaScript" type="text/javascript"><!--
d=document;var a='';a+=';r='+escape(d.referrer)
js=10//--></script><script language="JavaScript1.1" type="text/javascript"><!--
a+=';j='+navigator.javaEnabled()
js=11//--></script><script language="JavaScript1.2" type="text/javascript"><!--
s=screen;a+=';s='+s.width+'*'+s.height
a+=';d='+(s.colorDepth?s.colorDepth:s.pixelDepth)
js=12//--></script><script language="JavaScript1.3" type="text/javascript"><!--
js=13//--></script><script language="JavaScript" type="text/javascript"><!--
d.write('<a href="http://top.mail.ru/jump?from=1374183"'+
' target=_top><img src="http://d7.cf.b4.a1.top.list.ru/counter'+
'?id=1374183;t=48;js='+js+a+';rand='+Math.random()+
'" alt="Рейтинг@Mail.ru"'+' border=0 height=31 width=88/><\/a>')
if(11<js)d.write('<'+'!-- ')//--></script><noscript><a
target=_top href="http://top.mail.ru/jump?from=1374183"><img
src="http://d7.cf.b4.a1.top.list.ru/counter?js=na;id=1374183;t=48"
border=0 height=31 width=88
alt="Рейтинг@Mail.ru"/></a></noscript><script language="JavaScript" type="text/javascript"><!--
if(11<js)d.write('--'+'>')//--></script><!--/COUNTER-->

<!-- I.UA counter --><a href="http://www.i.ua/" target="_blank" onclick="this.href='http://i.ua/r.php?21595';" title="Rated by I.UA">
<script type="text/javascript" language="javascript"><!--
iS='<img src="http://r.i.ua/s?u21595&p66&n'+Math.random();
iD=document;iD.cookie="iua=1";if(iD.cookie)iS+='&c1';
iS+='&d'+(screen.colorDepth?screen.colorDepth:screen.pixelDepth)
+"&w"+screen.width+'&h'+screen.height
iT=iD.referrer.slice(7);iH=window.location.href.slice(7);
((iI=iT.indexOf('/'))!=-1)?(iT=iT.substring(0,iI)):(iI=iT.length);
if(iT!=iH.substring(0,iI))iS+='&f'+escape(iD.referrer.slice(7))
iS+='&r'+escape(iH);
iD.write(iS+'" border="0" width="88" height="31" />');
//--></script></a><!-- End of I.UA counter -->

<script type="text/javascript">
<!--
Nnv=navigator;Nna=Nnv.appName;Nd=document;Nd.cookie="b=b";Nc=0;if(Nd.cookie)Nc=1;
Nn=(Nna.substring(0,2)=="Mi")?0:1;Ns=screen;Npx=(Nn==0)?Ns.colorDepth:Ns.pixelDepth;
str='<img src="http://c.uarating.com/199;'+Ns.width+'x'+Ns.height+';'+Npx+';'+Nc+';';
str=str+escape(Nd.referrer)+';'+Math.random()+'" width="88" height="31" border="0">';
document.write('<a href="http://www.uarating.com/" alt="uaRating" target="_blank">'+str+'<\/a>');
// -->
</script>
<noscript><a href="http://www.uarating.com/" target="_blank"><img src="http://c.uarating.com/199;0x0;0;0;-;0" alt="uaRating" width="88" height="31" border="0"></a></noscript>


</td></tr>
</table>


</body>
</html>