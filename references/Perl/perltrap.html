<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
  <title>perltrap - perldoc.perl.org</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Language" content="en-gb" />
  <link href="css.css" rel="stylesheet" rev="stylesheet" type="text/css" media="screen" />
</head>

<script language="JavaScript" type="text/javascript" src="label.js"></script>

<script language="JavaScript">
  pageDepth = 0;
  setPath();
</script>

<body onLoad="showToolbars();loadLabels()">

<div id="pageHeader">
  <div id="pageHeaderLogo">
    <img src="onion.gif">
  </div>
  <div id="pageHeaderText">
    <a href="http://perldoc.perl.org">perldoc.perl.org</a>
  </div>
</div>

<div id="pageBody">
  <div id="left">
    <div id="leftContent">
      <div id="leftClose">
        <a href="#" onClick="closeLeft()" title="Hide navigation" onmouseover="leftCloseIcon.src='close_purple.gif';" onmouseout="leftCloseIcon.src='close_blue.gif';"><img src="close_blue.gif" name="leftCloseIcon" id="leftCloseIcon" border=0></a>
      </div>
      <h1>Manual:</h1>
      <ul>
        <li><a href="index-overview.html">Overview</a></li>
        <li><a href="index-tutorials.html">Tutorials</a></li>
        <li><a href="index-faq.html">FAQs</a></li>
        <li><a href="index-history.html">History / Changes</a></li>
        <li><a href="index-licence.html">Licence</a></li>
      </ul>
      <h2>Reference:</h2>
      <ul>
        <li><a href="index-language.html">Language</a></li>
        <li><a href="index-functions.html">Functions</a></li>
        <li><a href="perlop.html">Operators</a></li>
        <li><a href="perlvar.html">Special variables</a></li>
        <li><a href="index-pragmas.html">Pragmas</a></li>
        <li><a href="index-modules-A.html">Core modules</a></li>
        <li><a href="index-utilities.html">Utilities</a></li>
        <li><a href="index-internals.html">Internals</a></li>
        <li><a href="index-platforms.html">Platform specific</a></li>
      </ul>
      <h2>Links:</h2>
      <ul>
        <li><a href="http://search.cpan.org">CPAN</a></li>
        <li><a href="http://www.perl.com">Perl.com</a></li>
        <li><a href="http://www.perl.org">Perl.org</a></li>
        <li><a href="http://www.pm.org">Perl Mongers</a></li>
        <li><a href="http://www.perlmonks.org">Perl Monks</a></li>
        <li><a href="http://planet.perl.org">Planet Perl</a></li>
        <li><a href="http://use.perl.org">Use Perl</a></li>
      </ul>
      <h2>Contact:</h2>
      <ul>
        <li>Site maintained by<br><a href="http://perl.jonallen.info">Jon Allen</a>
            (<a href="http://perl.jonallen.info">JJ</a>)</li>
        <li class="spaced">Last updated on<br>23 April 2006</li>
	<li class="spaced">See the <a href="http://perl.jonallen.info/projects/perldoc">project page</a> for
	more details</li>
      </ul>
    </div>
  </div>

  <div id="center">  
    <div id="centerContent">
      <div id="contentHeader">
        <div id="contentHeaderLeft"><a href="#" onClick="showLeft()">Show navigation</a></div>
        <div id="contentHeaderCentre">-- Perl 5.8.8 documentation --</div>
        <div id="contentHeaderRight"><a href="#" onClick="showRight()">Show toolbar</a></div>
      </div>
      <div id="breadCrumbs"><a href="index.html">Home</a> &gt; <a href="index-tutorials.html">Tutorials</a> &gt; perltrap</div>
      <script language="JavaScript">fromSearch();</script>
      <div id="contentBody"><div class="title_container"><div class="page_title">perltrap</div><div class="pdf_link"><a href="perltrap.pdf">View as PDF</a></div><div class="pdf_img_link"><a href="perltrap.pdf"><img src="pdficon.gif" border=0></a></div></div><ul><li><a href="#NAME">NAME</a><li><a href="#DESCRIPTION">DESCRIPTION</a><ul><li><a href="#Awk-Traps">Awk Traps</a><li><a href="#C%2fC%2b%2b-Traps">C/C++ Traps</a><li><a href="#Sed-Traps">Sed Traps</a><li><a href="#Shell-Traps">Shell Traps</a><li><a href="#Perl-Traps">Perl Traps</a><li><a href="#Perl4-to-Perl5-Traps">Perl4 to Perl5 Traps</a><li><a href="#Discontinuance%2c-Deprecation%2c-and-BugFix-traps">Discontinuance, Deprecation, and BugFix traps</a><li><a href="#Parsing-Traps">Parsing Traps</a><li><a href="#Numerical-Traps">Numerical Traps</a><li><a href="#General-data-type-traps">General data type traps</a><li><a href="#Context-Traps---scalar%2c-list-contexts">Context Traps - scalar, list contexts</a><li><a href="#Precedence-Traps">Precedence Traps</a><li><a href="#General-Regular-Expression-Traps-using-s%2f%2f%2f%2c-etc.">General Regular Expression Traps using s///, etc.</a><li><a href="#Subroutine%2c-Signal%2c-Sorting-Traps">Subroutine, Signal, Sorting Traps</a><li><a href="#OS-Traps">OS Traps</a><li><a href="#Interpolation-Traps">Interpolation Traps</a><li><a href="#DBM-Traps">DBM Traps</a><li><a href="#Unclassified-Traps">Unclassified Traps</a></ul></ul><a name="NAME"></a><h1>NAME</h1>
<p>perltrap - Perl traps for the unwary</p>
<a name="DESCRIPTION"></a><h1>DESCRIPTION</h1>
<p>The biggest trap of all is forgetting to <code class="inline"><a class="l_k" href="functions/use.html">use</a> <a class="l_w" href="warnings.html">warnings</a></code>
 or use the <b>-w</b>
switch; see <a href="perllexwarn.html">perllexwarn</a> and <a href="perlrun.html">perlrun</a>. The second biggest trap is not
making your entire program runnable under <code class="inline"><a class="l_k" href="functions/use.html">use</a> <a class="l_w" href="strict.html">strict</a></code>
.  The third biggest
trap is not reading the list of changes in this version of Perl; see
<a href="perldelta.html">perldelta</a>.</p>
<a name="Awk-Traps"></a><h2>Awk Traps</h2>
<p>Accustomed <b>awk</b> users should take special note of the following:</p>
<ul>
<li>
<p>A Perl program executes only once, not once for each input line.  You can
do an implicit loop with <code class="inline">-n</code>
 or <code class="inline">-p</code>
.</p>
</li>
<li>
<p>The English module, loaded via</p>
<pre class="verbatim">    <a class="l_k" href="functions/use.html">use</a> <a class="l_w" href="English.html">English</a><span class="sc">;</span></pre>
<p>allows you to refer to special variables (like <code class="inline"><span class="i">$/</span></code>
) with names (like
$RS), as though they were in <b>awk</b>; see <a href="perlvar.html">perlvar</a> for details.</p>
</li>
<li>
<p>Semicolons are required after all simple statements in Perl (except
at the end of a block).  Newline is not a statement delimiter.</p>
</li>
<li>
<p>Curly brackets are required on <code class="inline"><a class="l_w" href="if.html">if</a></code>s and <code class="inline">while</code>
s.</p>
</li>
<li>
<p>Variables begin with "$", "@" or "%" in Perl.</p>
</li>
<li>
<p>Arrays index from 0.  Likewise string positions in substr() and
index().</p>
</li>
<li>
<p>You have to decide whether your array has numeric or string indices.</p>
</li>
<li>
<p>Hash values do not spring into existence upon mere reference.</p>
</li>
<li>
<p>You have to decide whether you want to use string or numeric
comparisons.</p>
</li>
<li>
<p>Reading an input line does not split it for you.  You get to split it
to an array yourself.  And the split() operator has different
arguments than <b>awk</b>'s.</p>
</li>
<li>
<p>The current input line is normally in $_, not $0.  It generally does
not have the newline stripped.  ($0 is the name of the program
executed.)  See <a href="perlvar.html">perlvar</a>.</p>
</li>
<li>
<p>$&lt;<i>digit</i>&gt; does not refer to fields--it refers to substrings matched
by the last match pattern.</p>
</li>
<li>
<p>The print() statement does not add field and record separators unless
you set <code class="inline"><span class="i">$,</span></code>
 and <code class="inline"><span class="i">$\</span></code>
.  You can set $OFS and $ORS if you're using
the English module.</p>
</li>
<li>
<p>You must open your files before you print to them.</p>
</li>
<li>
<p>The range operator is "..", not comma.  The comma operator works as in
C.</p>
</li>
<li>
<p>The match operator is "=~", not "~".  ("~" is the one's complement
operator, as in C.)</p>
</li>
<li>
<p>The exponentiation operator is "**", not "^".  "^" is the XOR
operator, as in C.  (You know, one could get the feeling that <b>awk</b> is
basically incompatible with C.)</p>
</li>
<li>
<p>The concatenation operator is ".", not the null string.  (Using the
null string would render <code class="inline"><span class="q">/pat/</span> /pat/</code>
 unparsable, because the third slash
would be interpreted as a division operator--the tokenizer is in fact
slightly context sensitive for operators like "/", "?", and "&gt;".
And in fact, "." itself can be the beginning of a number.)</p>
</li>
<li>
<p>The <code class="inline"><a class="l_k" href="functions/next.html">next</a></code>, <code class="inline"><a class="l_k" href="functions/exit.html">exit</a></code>, and <code class="inline"><a class="l_k" href="functions/continue.html">continue</a></code> keywords work differently.</p>
</li>
<li>
<p>The following variables work differently:</p>
<pre class="verbatim">      Awk	Perl
      ARGC	scalar @ARGV (compare with $#ARGV)
      ARGV[0]	$0
      FILENAME	$ARGV
      FNR	$. - something
      FS	(whatever you like)
      NF	$#Fld, or some such
      NR	$.
      OFMT	$#
      OFS	$,
      ORS	$\
      RLENGTH	length($&amp;)
      RS	$/
      RSTART	length($`)
      SUBSEP	$;</pre></li>
<li>
<p>You cannot set $RS to a pattern, only a string.</p>
</li>
<li>
<p>When in doubt, run the <b>awk</b> construct through <b>a2p</b> and see what it
gives you.</p>
</li>
</ul>
<a name="C%2fC%2b%2b-Traps"></a><h2>C/C++ Traps</h2>
<p>Cerebral C and C++ programmers should take note of the following:</p>
<ul>
<li>
<p>Curly brackets are required on <code class="inline"><a class="l_w" href="if.html">if</a></code>'s and <code class="inline">while</code>
's.</p>
</li>
<li>
<p>You must use <code class="inline">elsif</code>
 rather than <code class="inline">else if</code>
.</p>
</li>
<li>
<p>The <code class="inline">break</code>
 and <code class="inline"><a class="l_k" href="functions/continue.html">continue</a></code> keywords from C become in Perl <code class="inline"><a class="l_k" href="functions/last.html">last</a></code>
and <code class="inline"><a class="l_k" href="functions/next.html">next</a></code>, respectively.  Unlike in C, these do <i>not</i> work within a
<code class="inline"><a class="l_k" href="functions/do.html">do</a> <span class="s">{</span> <span class="s">}</span> while</code>
 construct.  See <a href="perlsyn.html#Loop-Control">"Loop Control" in perlsyn</a>.</p>
</li>
<li>
<p>There's no switch statement.  (But it's easy to build one on the fly,
see <a href="perlsyn.html#Basic-BLOCKs-and-Switch-Statements">"Basic BLOCKs and Switch Statements" in perlsyn</a>)</p>
</li>
<li>
<p>Variables begin with "$", "@" or "%" in Perl.</p>
</li>
<li>
<p>Comments begin with "#", not "/*" or "//".  Perl may interpret C/C++
comments as division operators, unterminated regular expressions or
the defined-or operator.</p>
</li>
<li>
<p>You can't take the address of anything, although a similar operator
in Perl is the backslash, which creates a reference.</p>
</li>
<li>
<p><code class="inline">ARGV</code>
 must be capitalized.  <code class="inline"><span class="i">$ARGV</span>[<span class="n">0</span>]</code>
 is C's <code class="inline">argv<span class="s">[</span><span class="n">1</span><span class="s">]</span></code>
, and <code class="inline">argv<span class="s">[</span><span class="n">0</span><span class="s">]</span></code>

ends up in <code class="inline"><span class="i">$0</span></code>
.</p>
</li>
<li>
<p>System calls such as link(), unlink(), rename(), etc. return nonzero for
success, not 0. (system(), however, returns zero for success.)</p>
</li>
<li>
<p>Signal handlers deal with signal names, not numbers.  Use <code class="inline"><a class="l_k" href="functions/kill.html">kill</a> -l</code>

to find their names on your system.</p>
</li>
</ul>
<a name="Sed-Traps"></a><h2>Sed Traps</h2>
<p>Seasoned <b>sed</b> programmers should take note of the following:</p>
<ul>
<li>
<p>A Perl program executes only once, not once for each input line.  You can
do an implicit loop with <code class="inline">-n</code>
 or <code class="inline">-p</code>
.</p>
</li>
<li>
<p>Backreferences in substitutions use "$" rather than "\".</p>
</li>
<li>
<p>The pattern matching metacharacters "(", ")", and "|" do not have backslashes
in front.</p>
</li>
<li>
<p>The range operator is <code class="inline">...</code>
, rather than comma.</p>
</li>
</ul>
<a name="Shell-Traps"></a><h2>Shell Traps</h2>
<p>Sharp shell programmers should take note of the following:</p>
<ul>
<li>
<p>The backtick operator does variable interpolation without regard to
the presence of single quotes in the command.</p>
</li>
<li>
<p>The backtick operator does no translation of the return value, unlike <b>csh</b>.</p>
</li>
<li>
<p>Shells (especially <b>csh</b>) do several levels of substitution on each
command line.  Perl does substitution in only certain constructs
such as double quotes, backticks, angle brackets, and search patterns.</p>
</li>
<li>
<p>Shells interpret scripts a little bit at a time.  Perl compiles the
entire program before executing it (except for <code class="inline">BEGIN</code>
 blocks, which
execute at compile time).</p>
</li>
<li>
<p>The arguments are available via @ARGV, not $1, $2, etc.</p>
</li>
<li>
<p>The environment is not automatically made available as separate scalar
variables.</p>
</li>
<li>
<p>The shell's <code class="inline">test</code>
 uses "=", "!=", "&lt;" etc for string comparisons and "-eq",
"-ne", "-lt" etc for numeric comparisons. This is the reverse of Perl, which
uses <code class="inline">eq</code>
, <code class="inline">ne</code>
, <code class="inline">lt</code>
 for string comparisons, and <code class="inline">==</code>
, <code class="inline">!=</code>
 <code class="inline">&lt;</code>
 etc
for numeric comparisons.</p>
</li>
</ul>
<a name="Perl-Traps"></a><h2>Perl Traps</h2>
<p>Practicing Perl Programmers should take note of the following:</p>
<ul>
<li>
<p>Remember that many operations behave differently in a list
context than they do in a scalar one.  See <a href="perldata.html">perldata</a> for details.</p>
</li>
<li>
<p>Avoid barewords if you can, especially all lowercase ones.
You can't tell by just looking at it whether a bareword is
a function or a string.  By using quotes on strings and
parentheses on function calls, you won't ever get them confused.</p>
</li>
<li>
<p>You cannot discern from mere inspection which builtins
are unary operators (like chop() and chdir())
and which are list operators (like print() and unlink()).
(Unless prototyped, user-defined subroutines can <b>only</b> be list
operators, never unary ones.)  See <a href="perlop.html">perlop</a> and <a href="perlsub.html">perlsub</a>.</p>
</li>
<li>
<p>People have a hard time remembering that some functions
default to $_, or @ARGV, or whatever, but that others which
you might expect to do not.</p>
</li>
<li>
<p>The &lt;FH&gt; construct is not the name of the filehandle, it is a readline
operation on that handle.  The data read is assigned to $_ only if the
file read is the sole condition in a while loop:</p>
<pre class="verbatim">    while <span class="s">(</span><span class="q">&lt;FH&gt;</span><span class="s">)</span>      <span class="s">{</span> <span class="s">}</span>
    while <span class="s">(</span><a class="l_k" href="functions/defined.html">defined</a><span class="s">(</span><span class="i">$_</span> = <span class="q">&lt;FH&gt;</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span> <span class="s">}</span>..
    <span class="q">&lt;FH&gt;</span><span class="sc">;</span>  <span class="c"># data discarded!</span></pre>
</li>
<li>
<p>Remember not to use <code class="inline">=</code>
 when you need <code class="inline">=~</code>
;
these two constructs are quite different:</p>
<pre class="verbatim">    <span class="i">$x</span> =  <span class="q">/foo/</span><span class="sc">;</span>
    <span class="i">$x</span> =~ <span class="q">/foo/</span><span class="sc">;</span></pre>
</li>
<li>
<p>The <code class="inline"><a class="l_k" href="functions/do.html">do</a> <span class="s">{</span><span class="s">}</span></code>
 construct isn't a real loop that you can use
loop control on.</p>
</li>
<li>
<p>Use <code class="inline"><a class="l_k" href="functions/my.html">my()</a></code> for local variables whenever you can get away with
it (but see <a href="perlform.html">perlform</a> for where you can't).
Using <code class="inline"><a class="l_k" href="functions/local.html">local()</a></code> actually gives a local value to a global
variable, which leaves you open to unforeseen side-effects
of dynamic scoping.</p>
</li>
<li>
<p>If you localize an exported variable in a module, its exported value will
not change.  The local name becomes an alias to a new value but the
external name is still an alias for the original.</p>
</li>
</ul>
<a name="Perl4-to-Perl5-Traps"></a><h2>Perl4 to Perl5 Traps</h2>
<p>Practicing Perl4 Programmers should take note of the following
Perl4-to-Perl5 specific traps.</p>
<p>They're crudely ordered according to the following list:</p>
<ul>
<li><a name="Discontinuance%2c-Deprecation%2c-and-BugFix-traps"></a><b>Discontinuance, Deprecation, and BugFix traps</b>
<p>Anything that's been fixed as a perl4 bug, removed as a perl4 feature
or deprecated as a perl4 feature with the intent to encourage usage of
some other perl5 feature.</p>
</li>
<li><a name="Parsing-Traps"></a><b>Parsing Traps</b>
<p>Traps that appear to stem from the new parser.</p>
</li>
<li><a name="Numerical-Traps"></a><b>Numerical Traps</b>
<p>Traps having to do with numerical or mathematical operators.</p>
</li>
<li><a name="General-data-type-traps"></a><b>General data type traps</b>
<p>Traps involving perl standard data types.</p>
</li>
<li><a name="Context-Traps---scalar%2c-list-contexts"></a><b>Context Traps - scalar, list contexts</b>
<p>Traps related to context within lists, scalar statements/declarations.</p>
</li>
<li><a name="Precedence-Traps"></a><b>Precedence Traps</b>
<p>Traps related to the precedence of parsing, evaluation, and execution of
code.</p>
</li>
<li><a name="General-Regular-Expression-Traps-using-s%2f%2f%2f%2c-etc."></a><b>General Regular Expression Traps using s///, etc.</b>
<p>Traps related to the use of pattern matching.</p>
</li>
<li><a name="Subroutine%2c-Signal%2c-Sorting-Traps"></a><b>Subroutine, Signal, Sorting Traps</b>
<p>Traps related to the use of signals and signal handlers, general subroutines,
and sorting, along with sorting subroutines.</p>
</li>
<li><a name="OS-Traps"></a><b>OS Traps</b>
<p>OS-specific traps.</p>
</li>
<li><a name="DBM-Traps"></a><b>DBM Traps</b>
<p>Traps specific to the use of <code class="inline"><a class="l_k" href="functions/dbmopen.html">dbmopen()</a></code>, and specific dbm implementations.</p>
</li>
<li><a name="Unclassified-Traps"></a><b>Unclassified Traps</b>
<p>Everything else.</p>
</li>
</ul>
<p>If you find an example of a conversion trap that is not listed here,
please submit it to &lt;<i>perlbug@perl.org</i>&gt; for inclusion.
Also note that at least some of these can be caught with the
<code class="inline"><a class="l_k" href="functions/use.html">use</a> <a class="l_w" href="warnings.html">warnings</a></code>
 pragma or the <b>-w</b> switch.</p>
<a name="Discontinuance%2c-Deprecation%2c-and-BugFix-traps"></a><h2>Discontinuance, Deprecation, and BugFix traps</h2>
<p>Anything that has been discontinued, deprecated, or fixed as
a bug from perl4.</p>
<ul>
<li><a name="*-Symbols-starting-with-%22_%22-no-longer-forced-into-main"></a><b>Symbols starting with "_" no longer forced into main</b>
<p>Symbols starting with "_" are no longer forced into package main, except
for <code class="inline"><span class="i">$_</span></code>
 itself (and <code class="inline"><span class="i">@_</span></code>
, etc.).</p>
<pre class="verbatim"><a name="package-test"></a>    package <span class="i">test</span><span class="sc">;</span>
    <span class="i">$_legacy</span> = <span class="n">1</span><span class="sc">;</span></pre>
<pre class="verbatim"><a name="package-main"></a>    package <span class="i">main</span><span class="sc">;</span>
    <a class="l_k" href="functions/print.html">print</a> <span class="q">&quot;\$_legacy is &quot;</span><span class="cm">,</span><span class="i">$_legacy</span><span class="cm">,</span><span class="q">&quot;\n&quot;</span><span class="sc">;</span></pre>
<pre class="verbatim">    <span class="c"># perl4 prints: $_legacy is 1</span>
    <span class="c"># perl5 prints: $_legacy is</span></pre>
</li>
<li><a name="*-Double-colon-valid-package-separator-in-variable-name"></a><b>Double-colon valid package separator in variable name</b>
<p>Double-colon is now a valid package separator in a variable name.  Thus these
behave differently in perl4 vs. perl5, because the packages don't exist.</p>
<pre class="verbatim">    <span class="i">$a</span>=<span class="n">1</span><span class="sc">;</span><span class="i">$b</span>=<span class="n">2</span><span class="sc">;</span><span class="i">$c</span>=<span class="n">3</span><span class="sc">;</span><span class="i">$var</span>=<span class="n">4</span><span class="sc">;</span>
    <a class="l_k" href="functions/print.html">print</a> <span class="q">&quot;$a::$b::$c &quot;</span><span class="sc">;</span>
    <a class="l_k" href="functions/print.html">print</a> <span class="q">&quot;$var::abc::xyz\n&quot;</span><span class="sc">;</span></pre>
<pre class="verbatim">    <span class="c"># perl4 prints: 1::2::3 4::abc::xyz</span>
    <span class="c"># perl5 prints: 3</span></pre>
<p>Given that <code class="inline">::</code>
 is now the preferred package delimiter, it is debatable
whether this should be classed as a bug or not.
(The older package delimiter, ' ,is used here)</p>
<pre class="verbatim">    <span class="i">$x</span> = <span class="n">10</span><span class="sc">;</span>
    <a class="l_k" href="functions/print.html">print</a> <span class="q">&quot;x=${&#39;x}\n&quot;</span><span class="sc">;</span></pre>
<pre class="verbatim">    <span class="c"># perl4 prints: x=10</span>
    <span class="c"># perl5 prints: Can&#39;t find string terminator &quot;&#39;&quot; anywhere before EOF</span></pre>
<p>You can avoid this problem, and remain compatible with perl4, if you
always explicitly include the package name:</p>
<pre class="verbatim">    <span class="i">$x</span> = <span class="n">10</span><span class="sc">;</span>
    <a class="l_k" href="functions/print.html">print</a> <span class="q">&quot;x=${main&#39;x}\n&quot;</span><span class="sc">;</span></pre>
<p>Also see precedence traps, for parsing <code class="inline"><span class="i">$:</span></code>
.</p>
</li>
<li><a name="*-2nd-and-3rd-args-to-'splice()'-are-now-in-scalar-context"></a><b>2nd and 3rd args to <code class="inline"><a class="l_k" href="functions/splice.html">splice()</a></code> are now in scalar context</b>
<p>The second and third arguments of <code class="inline"><a class="l_k" href="functions/splice.html">splice()</a></code> are now evaluated in scalar
context (as the Camel says) rather than list context.</p>
<pre class="verbatim"><a name="sub1"></a>    sub <span class="m">sub1</span><span class="s">{</span><a class="l_k" href="functions/return.html">return</a><span class="s">(</span><span class="n">0</span><span class="cm">,</span><span class="n">2</span><span class="s">)</span> <span class="s">}</span>          <span class="c"># return a 2-element list</span>
<a name="sub2"></a>    sub <span class="m">sub2</span><span class="s">{</span> <a class="l_k" href="functions/return.html">return</a><span class="s">(</span><span class="n">1</span><span class="cm">,</span><span class="n">2</span><span class="cm">,</span><span class="n">3</span><span class="s">)</span><span class="s">}</span>        <span class="c"># return a 3-element list</span>
    <span class="i">@a1</span> = <span class="s">(</span><span class="q">&quot;a&quot;</span><span class="cm">,</span><span class="q">&quot;b&quot;</span><span class="cm">,</span><span class="q">&quot;c&quot;</span><span class="cm">,</span><span class="q">&quot;d&quot;</span><span class="cm">,</span><span class="q">&quot;e&quot;</span><span class="s">)</span><span class="sc">;</span>
    <span class="i">@a2</span> = <a class="l_k" href="functions/splice.html">splice</a><span class="s">(</span><span class="i">@a1</span><span class="cm">,</span><span class="i">&amp;sub1</span><span class="cm">,</span><span class="i">&amp;sub2</span><span class="s">)</span><span class="sc">;</span>
    <a class="l_k" href="functions/print.html">print</a> <a class="l_k" href="functions/join.html">join</a><span class="s">(</span><span class="q">&#39; &#39;</span><span class="cm">,</span><span class="i">@a2</span><span class="s">)</span><span class="cm">,</span><span class="q">&quot;\n&quot;</span><span class="sc">;</span></pre>
<pre class="verbatim">    <span class="c"># perl4 prints: a b</span>
    <span class="c"># perl5 prints: c d e</span></pre>
</li>
<li><a name="*-Can't-do-'goto'-into-a-block-that-is-optimized-away"></a><b>Can't do <code class="inline"><a class="l_k" href="functions/goto.html">goto</a></code> into a block that is optimized away</b>
<p>You can't do a <code class="inline"><a class="l_k" href="functions/goto.html">goto</a></code> into a block that is optimized away.  Darn.</p>
<pre class="verbatim">    <a class="l_k" href="functions/goto.html">goto</a> <span class="j">marker1</span><span class="sc">;</span></pre>
<pre class="verbatim">    for<span class="s">(</span><span class="n">1</span><span class="s">)</span><span class="s">{</span>
    <span class="j">marker1:</span>
        <a class="l_k" href="functions/print.html">print</a> <span class="q">&quot;Here I is!\n&quot;</span><span class="sc">;</span>
    <span class="s">}</span></pre>
<pre class="verbatim">    <span class="c"># perl4 prints: Here I is!</span>
    <span class="c"># perl5 errors: Can&#39;t &quot;goto&quot; into the middle of a foreach loop</span></pre>
</li>
<li><a name="*-Can't-use-whitespace-as-variable-name-or-quote-delimiter"></a><b>Can't use whitespace as variable name or quote delimiter</b>
<p>It is no longer syntactically legal to use whitespace as the name
of a variable, or as a delimiter for any kind of quote construct.
Double darn.</p>
<pre class="verbatim">    $a = ("foo bar");
    $b = q baz;
    print "a is $a, b is $b\n";</pre><pre class="verbatim">    <span class="c"># perl4 prints: a is foo bar, b is baz</span>
    <span class="c"># perl5 errors: Bareword found where operator expected</span></pre>
</li>
<li><a name="*-'while%2fif-BLOCK-BLOCK'-gone"></a><b><code class="inline">while/if BLOCK BLOCK</code> gone</b>
<p>The archaic while/if BLOCK BLOCK syntax is no longer supported.</p>
<pre class="verbatim">    if { 1 } {
        print "True!";
    }
    else {
        print "False!";
    }</pre><pre class="verbatim">    <span class="c"># perl4 prints: True!</span>
    <span class="c"># perl5 errors: syntax error at test.pl line 1, near &quot;if {&quot;</span></pre>
</li>
<li><a name="*-'**'-binds-tighter-than-unary-minus"></a><b><code class="inline"><span class="i">**</span></code>
 binds tighter than unary minus</b>
<p>The <code class="inline"><span class="i">**</span></code>
 operator now binds more tightly than unary minus.
It was documented to work this way before, but didn't.</p>
<pre class="verbatim">    <a class="l_k" href="functions/print.html">print</a> <span class="n">-4</span>**<span class="n">2</span><span class="cm">,</span><span class="q">&quot;\n&quot;</span><span class="sc">;</span></pre>
<pre class="verbatim">    <span class="c"># perl4 prints: 16</span>
    <span class="c"># perl5 prints: -16</span></pre>
</li>
<li><a name="*-'foreach'-changed-when-iterating-over-a-list"></a><b><code class="inline">foreach</code>
 changed when iterating over a list</b>
<p>The meaning of <code class="inline">foreach<span class="s">{</span><span class="s">}</span></code>
 has changed slightly when it is iterating over a
list which is not an array.  This used to assign the list to a
temporary array, but no longer does so (for efficiency).  This means
that you'll now be iterating over the actual values, not over copies of
the values.  Modifications to the loop variable can change the original
values.</p>
<pre class="verbatim">    <span class="i">@list</span> = <span class="s">(</span><span class="q">&#39;ab&#39;</span><span class="cm">,</span><span class="q">&#39;abc&#39;</span><span class="cm">,</span><span class="q">&#39;bcd&#39;</span><span class="cm">,</span><span class="q">&#39;def&#39;</span><span class="s">)</span><span class="sc">;</span>
    foreach <span class="i">$var</span> <span class="s">(</span><a class="l_k" href="functions/grep.html">grep</a><span class="s">(</span><span class="q">/ab/</span><span class="cm">,</span><span class="i">@list</span><span class="s">)</span><span class="s">)</span><span class="s">{</span>
        <span class="i">$var</span> = <span class="n">1</span><span class="sc">;</span>
    <span class="s">}</span>
    <a class="l_k" href="functions/print.html">print</a> <span class="s">(</span><a class="l_k" href="functions/join.html">join</a><span class="s">(</span><span class="q">&#39;:&#39;</span><span class="cm">,</span><span class="i">@list</span><span class="s">)</span><span class="s">)</span><span class="sc">;</span></pre>
<pre class="verbatim">    <span class="c"># perl4 prints: ab:abc:bcd:def</span>
    <span class="c"># perl5 prints: 1:1:bcd:def</span></pre>
<p>To retain Perl4 semantics you need to assign your list
explicitly to a temporary array and then iterate over that.  For
example, you might need to change</p>
<pre class="verbatim">    foreach $var (grep(/ab/,@list)){</pre><p>to</p>
<pre class="verbatim">    foreach $var (@tmp = grep(/ab/,@list)){</pre><p>Otherwise changing $var will clobber the values of @list.  (This most often
happens when you use <code class="inline"><span class="i">$_</span></code>
 for the loop variable, and call subroutines in
the loop that don't properly localize <code class="inline"><span class="i">$_</span></code>
.)</p>
</li>
<li><a name="*-'split'-with-no-args-behavior-changed"></a><b><code class="inline"><a class="l_k" href="functions/split.html">split</a></code> with no args behavior changed</b>
<p><code class="inline"><a class="l_k" href="functions/split.html">split</a></code> with no arguments now behaves like <code class="inline"><a class="l_k" href="functions/split.html">split</a> <span class="q">&#39; &#39;</span></code>
 (which doesn't
return an initial null field if $_ starts with whitespace), it used to
behave like <code class="inline"><a class="l_k" href="functions/split.html">split</a> <span class="q">/\s+/</span></code>
 (which does).</p>
<pre class="verbatim">    <span class="i">$_</span> = <span class="q">&#39; hi mom&#39;</span><span class="sc">;</span>
    <a class="l_k" href="functions/print.html">print</a> <a class="l_k" href="functions/join.html">join</a><span class="s">(</span><span class="q">&#39;:&#39;</span><span class="cm">,</span> <a class="l_k" href="functions/split.html">split</a><span class="s">)</span><span class="sc">;</span></pre>
<pre class="verbatim">    <span class="c"># perl4 prints: :hi:mom</span>
    <span class="c"># perl5 prints: hi:mom</span></pre>
</li>
<li><a name="*-*-e*-behavior-fixed"></a><b><b>-e</b> behavior fixed</b>
<p>Perl 4 would ignore any text which was attached to an <b>-e</b> switch,
always taking the code snippet from the following arg.  Additionally, it
would silently accept an <b>-e</b> switch without a following arg.  Both of
these behaviors have been fixed.</p>
<pre class="verbatim">    perl -e'print "attached to -e"' 'print "separate arg"'</pre><pre class="verbatim">    <span class="c"># perl4 prints: separate arg</span>
    <span class="c"># perl5 prints: attached to -e</span></pre>
<pre class="verbatim">    perl -e</pre>
<pre class="verbatim">    <span class="c"># perl4 prints:</span>
    <span class="c"># perl5 dies: No code specified for -e.</span></pre>
</li>
<li><a name="*-'push'-returns-number-of-elements-in-resulting-list"></a><b><code class="inline"><a class="l_k" href="functions/push.html">push</a></code> returns number of elements in resulting list</b>
<p>In Perl 4 the return value of <code class="inline"><a class="l_k" href="functions/push.html">push</a></code> was undocumented, but it was
actually the last value being pushed onto the target list.  In Perl 5
the return value of <code class="inline"><a class="l_k" href="functions/push.html">push</a></code> is documented, but has changed, it is the
number of elements in the resulting list.</p>
<pre class="verbatim">    <span class="i">@x</span> = <span class="s">(</span><span class="q">&#39;existing&#39;</span><span class="s">)</span><span class="sc">;</span>
    <a class="l_k" href="functions/print.html">print</a> <a class="l_k" href="functions/push.html">push</a><span class="s">(</span><span class="i">@x</span><span class="cm">,</span> <span class="q">&#39;first new&#39;</span><span class="cm">,</span> <span class="q">&#39;second new&#39;</span><span class="s">)</span><span class="sc">;</span></pre>
<pre class="verbatim">    <span class="c"># perl4 prints: second new</span>
    <span class="c"># perl5 prints: 3</span></pre>
</li>
<li><a name="*-Some-error-messages-differ"></a><b>Some error messages differ</b>
<p>Some error messages will be different.</p>
</li>
<li><a name="*-'split()'-honors-subroutine-args"></a><b><code class="inline"><a class="l_k" href="functions/split.html">split()</a></code> honors subroutine args</b>
<p>In Perl 4, if in list context the delimiters to the first argument of
<code class="inline"><a class="l_k" href="functions/split.html">split()</a></code> were <code class="inline"><span class="q">??</span></code>
, the result would be placed in <code class="inline"><span class="i">@_</span></code>
 as well as
being returned.   Perl 5 has more respect for your subroutine arguments.</p>
</li>
<li><a name="*-Bugs-removed"></a><b>Bugs removed</b>
<p>Some bugs may have been inadvertently removed.  :-)</p>
</li>
</ul>
<a name="Parsing-Traps"></a><h2>Parsing Traps</h2>
<p>Perl4-to-Perl5 traps from having to do with parsing.</p>
<ul>
<li><a name="*-Space-between-.-and-%3d-triggers-syntax-error"></a><b>Space between . and = triggers syntax error</b>
<p>Note the space between . and =</p>
<pre class="verbatim">    <span class="i">$string</span> . = <span class="q">&quot;more string&quot;</span><span class="sc">;</span>
    <a class="l_k" href="functions/print.html">print</a> <span class="i">$string</span><span class="sc">;</span></pre>
<pre class="verbatim">    <span class="c"># perl4 prints: more string</span>
    <span class="c"># perl5 prints: syntax error at - line 1, near &quot;. =&quot;</span></pre>
</li>
<li><a name="*-Better-parsing-in-perl-5"></a><b>Better parsing in perl 5</b>
<p>Better parsing in perl 5</p>
<pre class="verbatim"><a name="foo"></a>    sub <span class="m">foo</span> <span class="s">{</span><span class="s">}</span>
    <span class="i">&amp;foo</span>
    <a class="l_k" href="functions/print.html">print</a><span class="s">(</span><span class="q">&quot;hello, world\n&quot;</span><span class="s">)</span><span class="sc">;</span></pre>
<pre class="verbatim">    <span class="c"># perl4 prints: hello, world</span>
    <span class="c"># perl5 prints: syntax error</span></pre>
</li>
<li><a name="*-Function-parsing"></a><b>Function parsing</b>
<p>"if it looks like a function, it is a function" rule.</p>
<pre class="verbatim">  <a class="l_k" href="functions/print.html">print</a>
    <span class="s">(</span><span class="i">$foo</span> == <span class="n">1</span><span class="s">)</span> ? <span class="q">&quot;is one\n&quot;</span> <span class="co">:</span> <span class="q">&quot;is zero\n&quot;</span><span class="sc">;</span></pre>
<pre class="verbatim">    <span class="c"># perl4 prints: is zero</span>
    <span class="c"># perl5 warns: &quot;Useless use of a constant in void context&quot; if using -w</span></pre>
</li>
<li><a name="*-String-interpolation-of-'%24%23array'-differs"></a><b>String interpolation of <code class="inline"><span class="i">$#array</span></code>
 differs</b>
<p>String interpolation of the <code class="inline"><span class="i">$#array</span></code>
 construct differs when braces
are to used around the name.</p>
<pre class="verbatim">    <span class="i">@a</span> = <span class="s">(</span><span class="n">1</span>..<span class="n">3</span><span class="s">)</span><span class="sc">;</span>
    <a class="l_k" href="functions/print.html">print</a> <span class="q">&quot;${#a}&quot;</span><span class="sc">;</span></pre>
<pre class="verbatim">    <span class="c"># perl4 prints: 2</span>
    <span class="c"># perl5 fails with syntax error</span></pre>
<pre class="verbatim">    @ = (1..3);
    print "$#{a}";</pre><pre class="verbatim">    <span class="c"># perl4 prints: {a}</span>
    <span class="c"># perl5 prints: 2</span></pre>
</li>
<li><a name="*-Perl-guesses-on-'map'%2c-'grep'-followed-by-'%7b'-if-it-starts-BLOCK-or-hash-ref"></a><b>Perl guesses on <code class="inline"><a class="l_k" href="functions/map.html">map</a></code>, <code class="inline"><a class="l_k" href="functions/grep.html">grep</a></code> followed by <code class="inline">{</code> if it starts BLOCK or hash ref</b>
<p>When perl sees <code class="inline">map {</code> (or <code class="inline">grep {</code>), it has to guess whether the <code class="inline">{</code>
starts a BLOCK or a hash reference. If it guesses wrong, it will report
a syntax error near the <code class="inline">}</code> and the missing (or unexpected) comma.</p>
<p>Use unary <code class="inline">+</code>
 before <code class="inline">{</code> on a hash reference, and unary <code class="inline">+</code>
 applied
to the first thing in a BLOCK (after <code class="inline">{</code>), for perl to guess right all
the time. (See <a href="functions/map.html">map</a>.)</p>
</li>
</ul>
<a name="Numerical-Traps"></a><h2>Numerical Traps</h2>
<p>Perl4-to-Perl5 traps having to do with numerical operators,
operands, or output from same.</p>
<ul>
<li><a name="*-Formatted-output-and-significant-digits"></a><b>Formatted output and significant digits</b>
<p>Formatted output and significant digits.  In general, Perl 5
tries to be more precise.  For example, on a Solaris Sparc:</p>
<pre class="verbatim">    <a class="l_k" href="functions/print.html">print</a> <span class="n">7.373504</span> - <span class="n">0</span><span class="cm">,</span> <span class="q">&quot;\n&quot;</span><span class="sc">;</span>
    <a class="l_k" href="functions/printf.html">printf</a> <span class="q">&quot;%20.18f\n&quot;</span><span class="cm">,</span> <span class="n">7.373504</span> - <span class="n">0</span><span class="sc">;</span></pre>
<pre class="verbatim">    # Perl4 prints:
    7.3750399999999996141
    7.375039999999999614</pre><pre class="verbatim">    # Perl5 prints:
    7.373504
    7.375039999999999614</pre><p>Notice how the first result looks better in Perl 5.</p>
<p>Your results may vary, since your floating point formatting routines
and even floating point format may be slightly different.</p>
</li>
<li><a name="*-Auto-increment-operator-over-signed-int-limit-deleted"></a><b>Auto-increment operator over signed int limit deleted</b>
<p>This specific item has been deleted.  It demonstrated how the auto-increment
operator would not catch when a number went over the signed int limit.  Fixed
in version 5.003_04.  But always be wary when using large integers.
If in doubt:</p>
<pre class="verbatim">   <a class="l_k" href="functions/use.html">use</a> <a class="l_w" href="Math/BigInt.html">Math::BigInt</a><span class="sc">;</span></pre>
</li>
<li><a name="*-Assignment-of-return-values-from-numeric-equality-tests-doesn't-work"></a><b>Assignment of return values from numeric equality tests doesn't work</b>
<p>Assignment of return values from numeric equality tests
does not work in perl5 when the test evaluates to false (0).
Logical tests now return a null, instead of 0</p>
<pre class="verbatim">    <span class="i">$p</span> = <span class="s">(</span><span class="i">$test</span> == <span class="n">1</span><span class="s">)</span><span class="sc">;</span>
    <a class="l_k" href="functions/print.html">print</a> <span class="i">$p</span><span class="cm">,</span><span class="q">&quot;\n&quot;</span><span class="sc">;</span></pre>
<pre class="verbatim">    <span class="c"># perl4 prints: 0</span>
    <span class="c"># perl5 prints:</span></pre>
<p>Also see <a href="#General-Regular-Expression-Traps-using-s%2f%2f%2f%2c-etc.">"General Regular Expression Traps using s///, etc."</a>
for another example of this new feature...</p>
</li>
<li><a name="*-Bitwise-string-ops"></a><b>Bitwise string ops</b>
<p>When bitwise operators which can operate upon either numbers or
strings (<code class="inline"><span class="i">&amp; |</span> ^ ~</code>
) are given only strings as arguments, perl4 would
treat the operands as bitstrings so long as the program contained a call
to the <code class="inline"><a class="l_k" href="functions/vec.html">vec()</a></code> function. perl5 treats the string operands as bitstrings.
(See <a href="perlop.html#Bitwise-String-Operators">"Bitwise String Operators" in perlop</a> for more details.)</p>
<pre class="verbatim">    <span class="i">$fred</span> = <span class="q">&quot;10&quot;</span><span class="sc">;</span>
    <span class="i">$barney</span> = <span class="q">&quot;12&quot;</span><span class="sc">;</span>
    <span class="i">$betty</span> = <span class="i">$fred</span> &amp; <span class="i">$barney</span><span class="sc">;</span>
    <a class="l_k" href="functions/print.html">print</a> <span class="q">&quot;$betty\n&quot;</span><span class="sc">;</span>
    <span class="c"># Uncomment the next line to change perl4&#39;s behavior</span>
    <span class="c"># ($dummy) = vec(&quot;dummy&quot;, 0, 0);</span></pre>
<pre class="verbatim">    <span class="c"># Perl4 prints:</span>
    <span class="n">8</span></pre>
<pre class="verbatim">    <span class="c"># Perl5 prints:</span>
    <span class="n">10</span></pre>
<pre class="verbatim">    <span class="c"># If vec() is used anywhere in the program, both print:</span>
    <span class="n">10</span></pre>
</li>
</ul>
<a name="General-data-type-traps"></a><h2>General data type traps</h2>
<p>Perl4-to-Perl5 traps involving most data-types, and their usage
within certain expressions and/or context.</p>
<ul>
<li><a name="*-Negative-array-subscripts-now-count-from-the-end-of-array"></a><b>Negative array subscripts now count from the end of array</b>
<p>Negative array subscripts now count from the end of the array.</p>
<pre class="verbatim">    <span class="i">@a</span> = <span class="s">(</span><span class="n">1</span><span class="cm">,</span> <span class="n">2</span><span class="cm">,</span> <span class="n">3</span><span class="cm">,</span> <span class="n">4</span><span class="cm">,</span> <span class="n">5</span><span class="s">)</span><span class="sc">;</span>
    <a class="l_k" href="functions/print.html">print</a> <span class="q">&quot;The third element of the array is $a[3] also expressed as $a[-2] \n&quot;</span><span class="sc">;</span></pre>
<pre class="verbatim">    <span class="c"># perl4 prints: The third element of the array is 4 also expressed as</span>
    <span class="c"># perl5 prints: The third element of the array is 4 also expressed as 4</span></pre>
</li>
<li><a name="*-Setting-'%24%23array'-lower-now-discards-array-elements"></a><b>Setting <code class="inline"><span class="i">$#array</span></code>
 lower now discards array elements</b>
<p>Setting <code class="inline"><span class="i">$#array</span></code>
 lower now discards array elements, and makes them
impossible to recover.</p>
<pre class="verbatim">    <span class="i">@a</span> = <span class="s">(</span>a<span class="cm">,</span>b<span class="cm">,</span>c<span class="cm">,</span>d<span class="cm">,</span>e<span class="s">)</span><span class="sc">;</span>
    <a class="l_k" href="functions/print.html">print</a> <span class="q">&quot;Before: &quot;</span><span class="cm">,</span><a class="l_k" href="functions/join.html">join</a><span class="s">(</span><span class="q">&#39;&#39;</span><span class="cm">,</span><span class="i">@a</span><span class="s">)</span><span class="sc">;</span>
    <span class="i">$#a</span> =<span class="n">1</span><span class="sc">;</span>
    <a class="l_k" href="functions/print.html">print</a> <span class="q">&quot;, After: &quot;</span><span class="cm">,</span><a class="l_k" href="functions/join.html">join</a><span class="s">(</span><span class="q">&#39;&#39;</span><span class="cm">,</span><span class="i">@a</span><span class="s">)</span><span class="sc">;</span>
    <span class="i">$#a</span> =<span class="n">3</span><span class="sc">;</span>
    <a class="l_k" href="functions/print.html">print</a> <span class="q">&quot;, Recovered: &quot;</span><span class="cm">,</span><a class="l_k" href="functions/join.html">join</a><span class="s">(</span><span class="q">&#39;&#39;</span><span class="cm">,</span><span class="i">@a</span><span class="s">)</span><span class="cm">,</span><span class="q">&quot;\n&quot;</span><span class="sc">;</span></pre>
<pre class="verbatim">    <span class="c"># perl4 prints: Before: abcde, After: ab, Recovered: abcd</span>
    <span class="c"># perl5 prints: Before: abcde, After: ab, Recovered: ab</span></pre>
</li>
<li><a name="*-Hashes-get-defined-before-use"></a><b>Hashes get defined before use</b>
<p>Hashes get defined before use</p>
<pre class="verbatim">    <a class="l_k" href="functions/local.html">local</a><span class="s">(</span><span class="i">$s</span><span class="cm">,</span><span class="i">@a</span><span class="cm">,</span><span class="i">%h</span><span class="s">)</span><span class="sc">;</span>
    <a class="l_k" href="functions/die.html">die</a> <span class="q">&quot;scalar \$s defined&quot;</span> if <a class="l_k" href="functions/defined.html">defined</a><span class="s">(</span><span class="i">$s</span><span class="s">)</span><span class="sc">;</span>
    <a class="l_k" href="functions/die.html">die</a> <span class="q">&quot;array \@a defined&quot;</span> if <a class="l_k" href="functions/defined.html">defined</a><span class="s">(</span><span class="i">@a</span><span class="s">)</span><span class="sc">;</span>
    <a class="l_k" href="functions/die.html">die</a> <span class="q">&quot;hash \%h defined&quot;</span> if <a class="l_k" href="functions/defined.html">defined</a><span class="s">(</span><span class="i">%h</span><span class="s">)</span><span class="sc">;</span></pre>
<pre class="verbatim">    <span class="c"># perl4 prints:</span>
    <span class="c"># perl5 dies: hash %h defined</span></pre>
<p>Perl will now generate a warning when it sees defined(@a) and
defined(%h).</p>
</li>
<li><a name="*-Glob-assignment-from-localized-variable-to-variable"></a><b>Glob assignment from localized variable to variable</b>
<p>glob assignment from variable to variable will fail if the assigned
variable is localized subsequent to the assignment</p>
<pre class="verbatim">    <span class="i">@a</span> = <span class="s">(</span><span class="q">&quot;This is Perl 4&quot;</span><span class="s">)</span><span class="sc">;</span>
    <span class="i">*b</span> = <span class="i">*a</span><span class="sc">;</span>
    <a class="l_k" href="functions/local.html">local</a><span class="s">(</span><span class="i">@a</span><span class="s">)</span><span class="sc">;</span>
    <a class="l_k" href="functions/print.html">print</a> <span class="i">@b</span><span class="cm">,</span><span class="q">&quot;\n&quot;</span><span class="sc">;</span></pre>
<pre class="verbatim">    <span class="c"># perl4 prints: This is Perl 4</span>
    <span class="c"># perl5 prints:</span></pre>
</li>
<li><a name="*-Assigning-'undef'-to-glob"></a><b>Assigning <code class="inline"><a class="l_k" href="functions/undef.html">undef</a></code> to glob</b>
<p>Assigning <code class="inline"><a class="l_k" href="functions/undef.html">undef</a></code> to a glob has no effect in Perl 5.   In Perl 4
it undefines the associated scalar (but may have other side effects
including SEGVs). Perl 5 will also warn if <code class="inline"><a class="l_k" href="functions/undef.html">undef</a></code> is assigned to a
typeglob. (Note that assigning <code class="inline"><a class="l_k" href="functions/undef.html">undef</a></code> to a typeglob is different
than calling the <code class="inline"><a class="l_k" href="functions/undef.html">undef</a></code> function on a typeglob (<code class="inline"><a class="l_k" href="functions/undef.html">undef</a> <span class="i">*foo</span></code>
), which
has quite a few effects.</p>
<pre class="verbatim">    <span class="i">$foo</span> = <span class="q">&quot;bar&quot;</span><span class="sc">;</span>
    <span class="i">*foo</span> = <a class="l_k" href="functions/undef.html">undef</a><span class="sc">;</span>
    <a class="l_k" href="functions/print.html">print</a> <span class="i">$foo</span><span class="sc">;</span></pre>
<pre class="verbatim">    <span class="c"># perl4 prints:</span>
    <span class="c"># perl4 warns: &quot;Use of uninitialized variable&quot; if using -w</span>
    <span class="c"># perl5 prints: bar</span>
    <span class="c"># perl5 warns: &quot;Undefined value assigned to typeglob&quot; if using -w</span></pre>
</li>
<li><a name="*-Changes-in-unary-negation-(of-strings)"></a><b>Changes in unary negation (of strings)</b>
<p>Changes in unary negation (of strings)
This change effects both the return value and what it
does to auto(magic)increment.</p>
<pre class="verbatim">    <span class="i">$x</span> = <span class="q">&quot;aaa&quot;</span><span class="sc">;</span>
    <a class="l_k" href="functions/print.html">print</a> ++<span class="i">$x</span><span class="cm">,</span><span class="q">&quot; : &quot;</span><span class="sc">;</span>
    <a class="l_k" href="functions/print.html">print</a> -<span class="i">$x</span><span class="cm">,</span><span class="q">&quot; : &quot;</span><span class="sc">;</span>
    <a class="l_k" href="functions/print.html">print</a> ++<span class="i">$x</span><span class="cm">,</span><span class="q">&quot;\n&quot;</span><span class="sc">;</span></pre>
<pre class="verbatim">    <span class="c"># perl4 prints: aab : -0 : 1</span>
    <span class="c"># perl5 prints: aab : -aab : aac</span></pre>
</li>
<li><a name="*-Modifying-of-constants-prohibited"></a><b>Modifying of constants prohibited</b>
<p>perl 4 lets you modify constants:</p>
<pre class="verbatim">    <span class="i">$foo</span> = <span class="q">&quot;x&quot;</span><span class="sc">;</span>
    <span class="i">&amp;mod</span><span class="s">(</span><span class="i">$foo</span><span class="s">)</span><span class="sc">;</span>
    for <span class="s">(</span><span class="i">$x</span> = <span class="n">0</span><span class="sc">;</span> <span class="i">$x</span> &lt; <span class="n">3</span><span class="sc">;</span> <span class="i">$x</span>++<span class="s">)</span> <span class="s">{</span>
        <span class="i">&amp;mod</span><span class="s">(</span><span class="q">&quot;a&quot;</span><span class="s">)</span><span class="sc">;</span>
    <span class="s">}</span>
<a name="mod"></a>    sub <span class="m">mod</span> <span class="s">{</span>
        <a class="l_k" href="functions/print.html">print</a> <span class="q">&quot;before: $_[0]&quot;</span><span class="sc">;</span>
        <span class="i">$_</span>[<span class="n">0</span>] = <span class="q">&quot;m&quot;</span><span class="sc">;</span>
        <a class="l_k" href="functions/print.html">print</a> <span class="q">&quot;  after: $_[0]\n&quot;</span><span class="sc">;</span>
    <span class="s">}</span></pre>
<pre class="verbatim">    <span class="c"># perl4:</span>
    <span class="c"># before: x  after: m</span>
    <span class="c"># before: a  after: m</span>
    <span class="c"># before: m  after: m</span>
    <span class="c"># before: m  after: m</span></pre>
<pre class="verbatim">    <span class="c"># Perl5:</span>
    <span class="c"># before: x  after: m</span>
    <span class="c"># Modification of a read-only value attempted at foo.pl line 12.</span>
    <span class="c"># before: a</span></pre>
</li>
<li><a name="*-'defined-%24var'-behavior-changed"></a><b><code class="inline"><a class="l_k" href="functions/defined.html">defined</a> <span class="i">$var</span></code>
 behavior changed</b>
<p>The behavior is slightly different for:</p>
<pre class="verbatim">    <a class="l_k" href="functions/print.html">print</a> <span class="q">&quot;$x&quot;</span><span class="cm">,</span> <a class="l_k" href="functions/defined.html">defined</a> <span class="i">$x</span></pre>
<pre class="verbatim">    <span class="c"># perl 4: 1</span>
    <span class="c"># perl 5: &lt;no output, $x is not called into existence&gt;</span></pre>
</li>
<li><a name="*-Variable-Suicide"></a><b>Variable Suicide</b>
<p>Variable suicide behavior is more consistent under Perl 5.
Perl5 exhibits the same behavior for hashes and scalars,
that perl4 exhibits for only scalars.</p>
<pre class="verbatim">    <span class="i">$aGlobal</span>{ <span class="q">&quot;aKey&quot;</span> } = <span class="q">&quot;global value&quot;</span><span class="sc">;</span>
    <a class="l_k" href="functions/print.html">print</a> <span class="q">&quot;MAIN:&quot;</span><span class="cm">,</span> <span class="i">$aGlobal</span>{<span class="q">&quot;aKey&quot;</span>}<span class="cm">,</span> <span class="q">&quot;\n&quot;</span><span class="sc">;</span>
    <span class="i">$GlobalLevel</span> = <span class="n">0</span><span class="sc">;</span>
    <span class="i">&amp;test</span><span class="s">(</span> <span class="i">*aGlobal</span> <span class="s">)</span><span class="sc">;</span></pre>
<pre class="verbatim"><a name="test"></a>    sub <span class="m">test</span> <span class="s">{</span>
        <a class="l_k" href="functions/local.html">local</a><span class="s">(</span> <span class="i">*theArgument</span> <span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
        <a class="l_k" href="functions/local.html">local</a><span class="s">(</span> <span class="i">%aNewLocal</span> <span class="s">)</span><span class="sc">;</span> <span class="c"># perl 4 != 5.001l,m</span>
        <span class="i">$aNewLocal</span>{<span class="q">&quot;aKey&quot;</span>} = <span class="q">&quot;this should never appear&quot;</span><span class="sc">;</span>
        <a class="l_k" href="functions/print.html">print</a> <span class="q">&quot;SUB: &quot;</span><span class="cm">,</span> <span class="i">$theArgument</span>{<span class="q">&quot;aKey&quot;</span>}<span class="cm">,</span> <span class="q">&quot;\n&quot;</span><span class="sc">;</span>
        <span class="i">$aNewLocal</span>{<span class="q">&quot;aKey&quot;</span>} = <span class="q">&quot;level $GlobalLevel&quot;</span><span class="sc">;</span>   <span class="c"># what should print</span>
        <span class="i">$GlobalLevel</span>++<span class="sc">;</span>
        if<span class="s">(</span> <span class="i">$GlobalLevel</span>&lt;<span class="n">4</span> <span class="s">)</span> <span class="s">{</span>
            <span class="i">&amp;test</span><span class="s">(</span> <span class="i">*aNewLocal</span> <span class="s">)</span><span class="sc">;</span>
        <span class="s">}</span>
    <span class="s">}</span></pre>
<pre class="verbatim">    <span class="c"># Perl4:</span>
    <span class="c"># MAIN:global value</span>
    <span class="c"># SUB: global value</span>
    <span class="c"># SUB: level 0</span>
    <span class="c"># SUB: level 1</span>
    <span class="c"># SUB: level 2</span></pre>
<pre class="verbatim">    <span class="c"># Perl5:</span>
    <span class="c"># MAIN:global value</span>
    <span class="c"># SUB: global value</span>
    <span class="c"># SUB: this should never appear</span>
    <span class="c"># SUB: this should never appear</span>
    <span class="c"># SUB: this should never appear</span></pre>
</li>
</ul>
<a name="Context-Traps---scalar%2c-list-contexts"></a><h2>Context Traps - scalar, list contexts</h2>
<ul>
<li><a name="*-Elements-of-argument-lists-for-formats-evaluated-in-list-context"></a><b>Elements of argument lists for formats evaluated in list context</b>
<p>The elements of argument lists for formats are now evaluated in list
context.  This means you can interpolate list values now.</p>
<pre class="verbatim">    @fmt = ("foo","bar","baz");
    format STDOUT=
    @&lt;&lt;&lt;&lt;&lt; @||||| @&gt;&gt;&gt;&gt;&gt;
    @fmt;
    .
    write;</pre><pre class="verbatim">    <span class="c"># perl4 errors:  Please use commas to separate fields in file</span>
    <span class="c"># perl5 prints: foo     bar      baz</span></pre>
</li>
<li><a name="*-'caller()'-returns-false-value-in-scalar-context-if-no-caller-present"></a><b><code class="inline"><a class="l_k" href="functions/caller.html">caller()</a></code> returns false value in scalar context if no caller present</b>
<p>The <code class="inline"><a class="l_k" href="functions/caller.html">caller()</a></code> function now returns a false value in a scalar context
if there is no caller.  This lets library files determine if they're
being required.</p>
<pre class="verbatim">    <a class="l_k" href="functions/caller.html">caller</a><span class="s">(</span><span class="s">)</span> ? <span class="s">(</span><a class="l_k" href="functions/print.html">print</a> <span class="q">&quot;You rang?\n&quot;</span><span class="s">)</span> <span class="co">:</span> <span class="s">(</span><a class="l_k" href="functions/print.html">print</a> <span class="q">&quot;Got a 0\n&quot;</span><span class="s">)</span><span class="sc">;</span></pre>
<pre class="verbatim">    <span class="c"># perl4 errors: There is no caller</span>
    <span class="c"># perl5 prints: Got a 0</span></pre>
</li>
<li><a name="*-Comma-operator-in-scalar-context-gives-scalar-context-to-args"></a><b>Comma operator in scalar context gives scalar context to args</b>
<p>The comma operator in a scalar context is now guaranteed to give a
scalar context to its arguments.</p>
<pre class="verbatim">    <span class="i">@y</span>= <span class="s">(</span><span class="q">&#39;a&#39;</span><span class="cm">,</span><span class="q">&#39;b&#39;</span><span class="cm">,</span><span class="q">&#39;c&#39;</span><span class="s">)</span><span class="sc">;</span>
    <span class="i">$x</span> = <span class="s">(</span><span class="n">1</span><span class="cm">,</span> <span class="n">2</span><span class="cm">,</span> <span class="i">@y</span><span class="s">)</span><span class="sc">;</span>
    <a class="l_k" href="functions/print.html">print</a> <span class="q">&quot;x = $x\n&quot;</span><span class="sc">;</span></pre>
<pre class="verbatim">    <span class="c"># Perl4 prints:  x = c   # Thinks list context interpolates list</span>
    <span class="c"># Perl5 prints:  x = 3   # Knows scalar uses length of list</span></pre>
</li>
<li><a name="*-'sprintf()'-prototyped-as-'(%24%3b%40)'"></a><b><code class="inline"><a class="l_k" href="functions/sprintf.html">sprintf()</a></code> prototyped as <code class="inline">($;@)</code></b>
<p><code class="inline"><a class="l_k" href="functions/sprintf.html">sprintf()</a></code> is prototyped as ($;@), so its first argument is given scalar
context. Thus, if passed an array, it will probably not do what you want,
unlike Perl 4:</p>
<pre class="verbatim">    <span class="i">@z</span> = <span class="s">(</span><span class="q">&#39;%s%s&#39;</span><span class="cm">,</span> <span class="q">&#39;foo&#39;</span><span class="cm">,</span> <span class="q">&#39;bar&#39;</span><span class="s">)</span><span class="sc">;</span>
    <span class="i">$x</span> = <a class="l_k" href="functions/sprintf.html">sprintf</a><span class="s">(</span><span class="i">@z</span><span class="s">)</span><span class="sc">;</span>
    <a class="l_k" href="functions/print.html">print</a> <span class="i">$x</span><span class="sc">;</span></pre>
<pre class="verbatim">    <span class="c"># perl4 prints: foobar</span>
    <span class="c"># perl5 prints: 3</span></pre>
<p><code class="inline"><a class="l_k" href="functions/printf.html">printf()</a></code> works the same as it did in Perl 4, though:</p>
<pre class="verbatim">    <span class="i">@z</span> = <span class="s">(</span><span class="q">&#39;%s%s&#39;</span><span class="cm">,</span> <span class="q">&#39;foo&#39;</span><span class="cm">,</span> <span class="q">&#39;bar&#39;</span><span class="s">)</span><span class="sc">;</span>
    <a class="l_k" href="functions/printf.html">printf</a> <span class="i">STDOUT</span> <span class="s">(</span><span class="i">@z</span><span class="s">)</span><span class="sc">;</span></pre>
<pre class="verbatim">    <span class="c"># perl4 prints: foobar</span>
    <span class="c"># perl5 prints: foobar</span></pre>
</li>
</ul>
<a name="Precedence-Traps"></a><h2>Precedence Traps</h2>
<p>Perl4-to-Perl5 traps involving precedence order.</p>
<p>Perl 4 has almost the same precedence rules as Perl 5 for the operators
that they both have.  Perl 4 however, seems to have had some
inconsistencies that made the behavior differ from what was documented.</p>
<ul>
<li><a name="*-LHS-vs.-RHS-of-any-assignment-operator"></a><b>LHS vs. RHS of any assignment operator</b>
<p>LHS vs. RHS of any assignment operator.  LHS is evaluated first
in perl4, second in perl5; this can affect the relationship
between side-effects in sub-expressions.</p>
<pre class="verbatim">    <span class="i">@arr</span> = <span class="s">(</span> <span class="q">&#39;left&#39;</span><span class="cm">,</span> <span class="q">&#39;right&#39;</span> <span class="s">)</span><span class="sc">;</span>
    <span class="i">$a</span>{<a class="l_k" href="functions/shift.html">shift</a> <span class="i">@arr</span>} = <a class="l_k" href="functions/shift.html">shift</a> <span class="i">@arr</span><span class="sc">;</span>
    <a class="l_k" href="functions/print.html">print</a> <a class="l_k" href="functions/join.html">join</a><span class="s">(</span> <span class="q">&#39; &#39;</span><span class="cm">,</span> <a class="l_k" href="functions/keys.html">keys</a> <span class="i">%a</span> <span class="s">)</span><span class="sc">;</span></pre>
<pre class="verbatim">    <span class="c"># perl4 prints: left</span>
    <span class="c"># perl5 prints: right</span></pre>
</li>
<li><a name="*-Semantic-errors-introduced-due-to-precedence"></a><b>Semantic errors introduced due to precedence</b>
<p>These are now semantic errors because of precedence:</p>
<pre class="verbatim">    <span class="i">@list</span> = <span class="s">(</span><span class="n">1</span><span class="cm">,</span><span class="n">2</span><span class="cm">,</span><span class="n">3</span><span class="cm">,</span><span class="n">4</span><span class="cm">,</span><span class="n">5</span><span class="s">)</span><span class="sc">;</span>
    <span class="i">%map</span> = <span class="s">(</span><span class="q">&quot;a&quot;</span><span class="cm">,</span><span class="n">1</span><span class="cm">,</span><span class="q">&quot;b&quot;</span><span class="cm">,</span><span class="n">2</span><span class="cm">,</span><span class="q">&quot;c&quot;</span><span class="cm">,</span><span class="n">3</span><span class="cm">,</span><span class="q">&quot;d&quot;</span><span class="cm">,</span><span class="n">4</span><span class="s">)</span><span class="sc">;</span>
    <span class="i">$n</span> = <a class="l_k" href="functions/shift.html">shift</a> <span class="i">@list</span> + <span class="n">2</span><span class="sc">;</span>   <span class="c"># first item in list plus 2</span>
    <a class="l_k" href="functions/print.html">print</a> <span class="q">&quot;n is $n, &quot;</span><span class="sc">;</span>
    <span class="i">$m</span> = <a class="l_k" href="functions/keys.html">keys</a> <span class="i">%map</span> + <span class="n">2</span><span class="sc">;</span>     <span class="c"># number of items in hash plus 2</span>
    <a class="l_k" href="functions/print.html">print</a> <span class="q">&quot;m is $m\n&quot;</span><span class="sc">;</span></pre>
<pre class="verbatim">    <span class="c"># perl4 prints: n is 3, m is 6</span>
    <span class="c"># perl5 errors and fails to compile</span></pre>
</li>
<li><a name="*-Precedence-of-assignment-operators-same-as-the-precedence-of-assignment"></a><b>Precedence of assignment operators same as the precedence of assignment</b>
<p>The precedence of assignment operators is now the same as the precedence
of assignment.  Perl 4 mistakenly gave them the precedence of the associated
operator.  So you now must parenthesize them in expressions like</p>
<pre class="verbatim">    <span class="q">/foo/</span> ? <span class="s">(</span><span class="i">$a</span> += <span class="n">2</span><span class="s">)</span> <span class="co">:</span> <span class="s">(</span><span class="i">$a</span> -= <span class="n">2</span><span class="s">)</span><span class="sc">;</span></pre>
<p>Otherwise</p>
<pre class="verbatim">    <span class="q">/foo/</span> ? <span class="i">$a</span> += <span class="n">2</span> <span class="co">:</span> <span class="i">$a</span> -= <span class="n">2</span></pre>
<p>would be erroneously parsed as</p>
<pre class="verbatim">    <span class="s">(</span><span class="q">/foo/</span> ? <span class="i">$a</span> += <span class="n">2</span> <span class="co">:</span> <span class="i">$a</span><span class="s">)</span> -= <span class="n">2</span><span class="sc">;</span></pre>
<p>On the other hand,</p>
<pre class="verbatim">    <span class="i">$a</span> += <span class="q">/foo/</span> ? <span class="n">1</span> <span class="co">:</span> <span class="n">2</span><span class="sc">;</span></pre>
<p>now works as a C programmer would expect.</p>
</li>
<li><a name="*-'open'-requires-parentheses-around-filehandle"></a><b><code class="inline"><a class="l_k" href="functions/open.html">open</a></code> requires parentheses around filehandle</b>
<pre class="verbatim">    <a class="l_k" href="functions/open.html">open</a> FOO || <a class="l_k" href="functions/die.html">die</a><span class="sc">;</span></pre>
<p>is now incorrect.  You need parentheses around the filehandle.
Otherwise, perl5 leaves the statement as its default precedence:</p>
<pre class="verbatim">    <a class="l_k" href="functions/open.html">open</a><span class="s">(</span>FOO || <a class="l_k" href="functions/die.html">die</a><span class="s">)</span><span class="sc">;</span></pre>
<pre class="verbatim">    <span class="c"># perl4 opens or dies</span>
    <span class="c"># perl5 opens FOO, dying only if &#39;FOO&#39; is false, i.e. never</span></pre>
</li>
<li><a name="*-'%24%3a'-precedence-over-'%24%3a%3a'-gone"></a><b><code class="inline"><span class="i">$:</span></code>
 precedence over <code class="inline"><span class="i">$::</span></code>
 gone</b>
<p>perl4 gives the special variable, <code class="inline"><span class="i">$:</span></code>
 precedence, where perl5
treats <code class="inline"><span class="i">$::</span></code>
 as main <code class="inline"><a class="l_k" href="functions/package.html">package</a></code></p>
<pre class="verbatim">    <span class="i">$a</span> = <span class="q">&quot;x&quot;</span><span class="sc">;</span> <a class="l_k" href="functions/print.html">print</a> <span class="q">&quot;$::a&quot;</span><span class="sc">;</span></pre>
<pre class="verbatim">    <span class="c"># perl 4 prints: -:a</span>
    <span class="c"># perl 5 prints: x</span></pre>
</li>
<li><a name="*-Precedence-of-file-test-operators-documented"></a><b>Precedence of file test operators documented</b>
<p>perl4 had buggy precedence for the file test operators vis-a-vis
the assignment operators.  Thus, although the precedence table
for perl4 leads one to believe <code class="inline">-e <span class="i">$foo</span> .= <span class="q">&quot;q&quot;</span></code>
 should parse as
<code class="inline"><span class="s">(</span><span class="s">(</span>-e <span class="i">$foo</span><span class="s">)</span> .= <span class="q">&quot;q&quot;</span><span class="s">)</span></code>
, it actually parses as <code class="inline"><span class="s">(</span>-e <span class="s">(</span><span class="i">$foo</span> .= <span class="q">&quot;q&quot;</span><span class="s">)</span><span class="s">)</span></code>
.
In perl5, the precedence is as documented.</p>
<pre class="verbatim">    -e <span class="i">$foo</span> .= <span class="q">&quot;q&quot;</span></pre>
<pre class="verbatim">    <span class="c"># perl4 prints: no output</span>
    <span class="c"># perl5 prints: Can&#39;t modify -e in concatenation</span></pre>
</li>
<li><a name="*-'keys'%2c-'each'%2c-'values'-are-regular-named-unary-operators"></a><b><code class="inline"><a class="l_k" href="functions/keys.html">keys</a></code>, <code class="inline"><a class="l_k" href="functions/each.html">each</a></code>, <code class="inline"><a class="l_k" href="functions/values.html">values</a></code> are regular named unary operators</b>
<p>In perl4, keys(), each() and values() were special high-precedence operators
that operated on a single hash, but in perl5, they are regular named unary
operators.  As documented, named unary operators have lower precedence
than the arithmetic and concatenation operators <code class="inline">+ - .</code>, but the perl4
variants of these operators actually bind tighter than <code class="inline">+ - .</code>.
Thus, for:</p>
<pre class="verbatim">    <span class="i">%foo</span> = <span class="n">1</span>..<span class="n">10</span><span class="sc">;</span>
    <a class="l_k" href="functions/print.html">print</a> <a class="l_k" href="functions/keys.html">keys</a> <span class="i">%foo</span> - <span class="n">1</span></pre>
<pre class="verbatim">    <span class="c"># perl4 prints: 4</span>
    <span class="c"># perl5 prints: Type of arg 1 to keys must be hash (not subtraction)</span></pre>
<p>The perl4 behavior was probably more useful, if less consistent.</p>
</li>
</ul>
<a name="General-Regular-Expression-Traps-using-s%2f%2f%2f%2c-etc."></a><h2>General Regular Expression Traps using s///, etc.</h2>
<p>All types of RE traps.</p>
<ul>
<li><a name="*-'s'%24lhs'%24rhs''-interpolates-on-either-side"></a><b><code class="inline"><a class="l_k" href="functions/s.html">s'$lhs'$rhs'</a></code> interpolates on either side</b>
<p><code class="inline"><a class="l_k" href="functions/s.html">s'$lhs'$rhs'</a></code> now does no interpolation on either side.  It used to
interpolate $lhs but not $rhs.  (And still does not match a literal
'$' in string)</p>
<pre class="verbatim">    <span class="i">$a</span>=<span class="n">1</span><span class="sc">;</span><span class="i">$b</span>=<span class="n">2</span><span class="sc">;</span>
    <span class="i">$string</span> = <span class="q">&#39;1 2 $a $b&#39;</span><span class="sc">;</span>
    <span class="i">$string</span> =~ <span class="q">s&#39;$a&#39;$b&#39;</span><span class="sc">;</span>
    <a class="l_k" href="functions/print.html">print</a> <span class="i">$string</span><span class="cm">,</span><span class="q">&quot;\n&quot;</span><span class="sc">;</span></pre>
<pre class="verbatim">    <span class="c"># perl4 prints: $b 2 $a $b</span>
    <span class="c"># perl5 prints: 1 2 $a $b</span></pre>
</li>
<li><a name="*-'m%2f%2fg'-attaches-its-state-to-the-searched-string"></a><b><code class="inline"><a class="l_k" href="functions/m.html">m//g</a></code> attaches its state to the searched string</b>
<p><code class="inline"><a class="l_k" href="functions/m.html">m//g</a></code> now attaches its state to the searched string rather than the
regular expression.  (Once the scope of a block is left for the sub, the
state of the searched string is lost)</p>
<pre class="verbatim">    <span class="i">$_</span> = <span class="q">&quot;ababab&quot;</span><span class="sc">;</span>
    while<span class="s">(</span><span class="q">m/ab/g</span><span class="s">)</span><span class="s">{</span>
        <span class="i">&amp;doit</span><span class="s">(</span><span class="q">&quot;blah&quot;</span><span class="s">)</span><span class="sc">;</span>
    <span class="s">}</span>
<a name="doit"></a>    sub <span class="m">doit</span><span class="s">{</span><a class="l_k" href="functions/local.html">local</a><span class="s">(</span><span class="i">$_</span><span class="s">)</span> = <a class="l_k" href="functions/shift.html">shift</a><span class="sc">;</span> <a class="l_k" href="functions/print.html">print</a> <span class="q">&quot;Got $_ &quot;</span><span class="s">}</span></pre>
<pre class="verbatim">    <span class="c"># perl4 prints: Got blah Got blah Got blah Got blah</span>
    <span class="c"># perl5 prints: infinite loop blah...</span></pre>
</li>
<li><a name="*-'m%2f%2fo'-used-within-an-anonymous-sub"></a><b><code class="inline"><a class="l_k" href="functions/m.html">m//o</a></code> used within an anonymous sub</b>
<p>Currently, if you use the <code class="inline"><a class="l_k" href="functions/m.html">m//o</a></code> qualifier on a regular expression
within an anonymous sub, <i>all</i> closures generated from that anonymous
sub will use the regular expression as it was compiled when it was used
the very first time in any such closure.  For instance, if you say</p>
<pre class="verbatim"><a name="build_match"></a>    sub <span class="m">build_match</span> <span class="s">{</span>
        <a class="l_k" href="functions/my.html">my</a><span class="s">(</span><span class="i">$left</span><span class="cm">,</span><span class="i">$right</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
        <a class="l_k" href="functions/return.html">return</a> <a class="l_k" href="functions/sub.html">sub</a> <span class="s">{</span> <span class="i">$_</span>[<span class="n">0</span>] =~ <span class="q">/$left stuff $right/o</span><span class="sc">;</span> <span class="s">}</span><span class="sc">;</span>
    <span class="s">}</span>
    <span class="i">$good</span> = <span class="i">build_match</span><span class="s">(</span><span class="q">&#39;foo&#39;</span><span class="cm">,</span><span class="q">&#39;bar&#39;</span><span class="s">)</span><span class="sc">;</span>
    <span class="i">$bad</span> = <span class="i">build_match</span><span class="s">(</span><span class="q">&#39;baz&#39;</span><span class="cm">,</span><span class="q">&#39;blarch&#39;</span><span class="s">)</span><span class="sc">;</span>
    <a class="l_k" href="functions/print.html">print</a> <span class="i">$good</span>-&gt;<span class="s">(</span><span class="q">&#39;foo stuff bar&#39;</span><span class="s">)</span> ? <span class="q">&quot;ok\n&quot;</span> <span class="co">:</span> <span class="q">&quot;not ok\n&quot;</span><span class="sc">;</span>
    <a class="l_k" href="functions/print.html">print</a> <span class="i">$bad</span>-&gt;<span class="s">(</span><span class="q">&#39;baz stuff blarch&#39;</span><span class="s">)</span> ? <span class="q">&quot;ok\n&quot;</span> <span class="co">:</span> <span class="q">&quot;not ok\n&quot;</span><span class="sc">;</span>
    <a class="l_k" href="functions/print.html">print</a> <span class="i">$bad</span>-&gt;<span class="s">(</span><span class="q">&#39;foo stuff bar&#39;</span><span class="s">)</span> ? <span class="q">&quot;not ok\n&quot;</span> <span class="co">:</span> <span class="q">&quot;ok\n&quot;</span><span class="sc">;</span></pre>
<p>For most builds of Perl5, this will print:
ok
not ok
not ok</p>
<p>build_match() will always return a sub which matches the contents of
$left and $right as they were the <i>first</i> time that build_match()
was called, not as they are in the current call.</p>
</li>
<li><a name="*-'%24%2b'-isn't-set-to-whole-match"></a><b><code class="inline"><span class="i">$+</span></code>
 isn't set to whole match</b>
<p>If no parentheses are used in a match, Perl4 sets <code class="inline"><span class="i">$+</span></code>
 to
the whole match, just like <code class="inline"><span class="i">$&amp;</span></code>
. Perl5 does not.</p>
<pre class="verbatim">    <span class="q">&quot;abcdef&quot;</span> =~ <span class="q">/b.*e/</span><span class="sc">;</span>
    <a class="l_k" href="functions/print.html">print</a> <span class="q">&quot;\$+ = $+\n&quot;</span><span class="sc">;</span></pre>
<pre class="verbatim">    <span class="c"># perl4 prints: bcde</span>
    <span class="c"># perl5 prints:</span></pre>
</li>
<li><a name="*-Substitution-now-returns-null-string-if-it-fails"></a><b>Substitution now returns null string if it fails</b>
<p>substitution now returns the null string if it fails</p>
<pre class="verbatim">    <span class="i">$string</span> = <span class="q">&quot;test&quot;</span><span class="sc">;</span>
    <span class="i">$value</span> = <span class="s">(</span><span class="i">$string</span> =~ <span class="q">s/foo//</span><span class="s">)</span><span class="sc">;</span>
    <a class="l_k" href="functions/print.html">print</a> <span class="i">$value</span><span class="cm">,</span> <span class="q">&quot;\n&quot;</span><span class="sc">;</span></pre>
<pre class="verbatim">    <span class="c"># perl4 prints: 0</span>
    <span class="c"># perl5 prints:</span></pre>
<p>Also see <a href="#Numerical-Traps">"Numerical Traps"</a> for another example of this new feature.</p>
</li>
<li><a name="*-'s%60lhs%60rhs%60'-is-now-a-normal-substitution"></a><b><code class="inline"><a class="l_k" href="functions/s.html">s`lhs`rhs`</a></code> is now a normal substitution</b>
<p><code class="inline"><a class="l_k" href="functions/s.html">s`lhs`rhs`</a></code> (using backticks) is now a normal substitution, with no
backtick expansion</p>
<pre class="verbatim">    <span class="i">$string</span> = <span class="q">&quot;&quot;</span><span class="sc">;</span>
    <span class="i">$string</span> =~ <span class="q">s`^`hostname`</span><span class="sc">;</span>
    <a class="l_k" href="functions/print.html">print</a> <span class="i">$string</span><span class="cm">,</span> <span class="q">&quot;\n&quot;</span><span class="sc">;</span></pre>
<pre class="verbatim">    <span class="c"># perl4 prints: &lt;the local hostname&gt;</span>
    <span class="c"># perl5 prints: hostname</span></pre>
</li>
<li><a name="*-Stricter-parsing-of-variables-in-regular-expressions"></a><b>Stricter parsing of variables in regular expressions</b>
<p>Stricter parsing of variables used in regular expressions</p>
<pre class="verbatim">    <span class="q">s/^([^$grpc]*$grpc[$opt$plus$rep]?)//o</span><span class="sc">;</span></pre>
<pre class="verbatim">    <span class="c"># perl4: compiles w/o error</span>
    <span class="c"># perl5: with Scalar found where operator expected ..., near &quot;$opt$plus&quot;</span></pre>
<p>an added component of this example, apparently from the same script, is
the actual value of the s'd string after the substitution.
<code class="inline"><span class="s">[</span><span class="i">$opt</span><span class="s">]</span></code>
 is a character class in perl4 and an array subscript in perl5</p>
<pre class="verbatim">    <span class="i">$grpc</span> = <span class="q">&#39;a&#39;</span><span class="sc">;</span>
    <span class="i">$opt</span>  = <span class="q">&#39;r&#39;</span><span class="sc">;</span>
    <span class="i">$_</span> = <span class="q">&#39;bar&#39;</span><span class="sc">;</span>
    <span class="q">s/^([^$grpc]*$grpc[$opt]?)/foo/</span><span class="sc">;</span>
    <a class="l_k" href="functions/print.html">print</a><span class="sc">;</span></pre>
<pre class="verbatim">    <span class="c"># perl4 prints: foo</span>
    <span class="c"># perl5 prints: foobar</span></pre>
</li>
<li><a name="*-'m%3fx%3f'-matches-only-once"></a><b><code class="inline"><a class="l_k" href="functions/m.html">m?x?</a></code> matches only once</b>
<p>Under perl5, <code class="inline"><a class="l_k" href="functions/m.html">m?x?</a></code> matches only once, like <code class="inline"><span class="q">?x?</span></code>
. Under perl4, it matched
repeatedly, like <code class="inline"><span class="q">/x/</span></code>
 or <code class="inline"><a class="l_k" href="functions/m.html">m!x!</a></code>.</p>
<pre class="verbatim">    <span class="i">$test</span> = <span class="q">&quot;once&quot;</span><span class="sc">;</span>
<a name="match"></a>    sub <span class="m">match</span> <span class="s">{</span> <span class="i">$test</span> =~ <span class="q">m?once?</span><span class="sc">;</span> <span class="s">}</span>
    <span class="i">&amp;match</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
    if<span class="s">(</span> <span class="i">&amp;match</span><span class="s">(</span><span class="s">)</span> <span class="s">)</span> <span class="s">{</span>
        <span class="c"># m?x? matches more then once</span>
        <a class="l_k" href="functions/print.html">print</a> <span class="q">&quot;perl4\n&quot;</span><span class="sc">;</span>
    <span class="s">}</span> else <span class="s">{</span>
        <span class="c"># m?x? matches only once</span>
        <a class="l_k" href="functions/print.html">print</a> <span class="q">&quot;perl5\n&quot;</span><span class="sc">;</span>
    <span class="s">}</span></pre>
<pre class="verbatim">    <span class="c"># perl4 prints: perl4</span>
    <span class="c"># perl5 prints: perl5</span></pre>
</li>
<li><a name="*-Failed-matches-don't-reset-the-match-variables"></a><b>Failed matches don't reset the match variables</b>
<p>Unlike in Ruby, failed matches in Perl do not reset the match variables
($1, $2, ..., <code class="inline"><span class="i">$`</span></code>
, ...).</p>
</li>
</ul>
<a name="Subroutine%2c-Signal%2c-Sorting-Traps"></a><h2>Subroutine, Signal, Sorting Traps</h2>
<p>The general group of Perl4-to-Perl5 traps having to do with
Signals, Sorting, and their related subroutines, as well as
general subroutine traps.  Includes some OS-Specific traps.</p>
<ul>
<li><a name="*-Barewords-that-used-to-look-like-strings-look-like-subroutine-calls"></a><b>Barewords that used to look like strings look like subroutine calls</b>
<p>Barewords that used to look like strings to Perl will now look like subroutine
calls if a subroutine by that name is defined before the compiler sees them.</p>
<pre class="verbatim"><a name="SeeYa"></a>    sub <span class="m">SeeYa</span> <span class="s">{</span> <a class="l_k" href="functions/warn.html">warn</a><span class="q">&quot;Hasta la vista, baby!&quot;</span> <span class="s">}</span>
    <span class="i">$SIG</span>{<span class="q">&#39;TERM&#39;</span>} = <span class="i">SeeYa</span><span class="sc">;</span>
    <a class="l_k" href="functions/print.html">print</a> <span class="q">&quot;SIGTERM is now $SIG{&#39;TERM&#39;}\n&quot;</span><span class="sc">;</span></pre>
<pre class="verbatim">    <span class="c"># perl4 prints: SIGTERM is now main&#39;SeeYa</span>
    <span class="c"># perl5 prints: SIGTERM is now main::1 (and warns &quot;Hasta la vista, baby!&quot;)</span></pre>
<p>Use <b>-w</b> to catch this one</p>
</li>
<li><a name="*-Reverse-is-no-longer-allowed-as-the-name-of-a-sort-subroutine"></a><b>Reverse is no longer allowed as the name of a sort subroutine</b>
<p>reverse is no longer allowed as the name of a sort subroutine.</p>
<pre class="verbatim"><a name="reverse"></a>    sub <span class="m">reverse</span><span class="s">{</span> <a class="l_k" href="functions/print.html">print</a> <span class="q">&quot;yup &quot;</span><span class="sc">;</span> <span class="i">$a</span> &lt;=&gt; <span class="i">$b</span> <span class="s">}</span>
    <a class="l_k" href="functions/print.html">print</a> <a class="l_k" href="functions/sort.html">sort</a> <a class="l_k" href="functions/reverse.html">reverse</a> <span class="s">(</span><span class="n">2</span><span class="cm">,</span><span class="n">1</span><span class="cm">,</span><span class="n">3</span><span class="s">)</span><span class="sc">;</span></pre>
<pre class="verbatim">    <span class="c"># perl4 prints: yup yup 123</span>
    <span class="c"># perl5 prints: 123</span>
    <span class="c"># perl5 warns (if using -w): Ambiguous call resolved as CORE::reverse()</span></pre>
</li>
<li><a name="*-'warn()'-won't-let-you-specify-a-filehandle."></a><b><code class="inline"><a class="l_k" href="functions/warn.html">warn()</a></code> won't let you specify a filehandle.</b>
<p>Although it _always_ printed to STDERR, warn() would let you specify a
filehandle in perl4.  With perl5 it does not.</p>
<pre class="verbatim">    <a class="l_k" href="functions/warn.html">warn</a> STDERR <span class="q">&quot;Foo!&quot;</span><span class="sc">;</span></pre>
<pre class="verbatim">    <span class="c"># perl4 prints: Foo!</span>
    <span class="c"># perl5 prints: String found where operator expected</span></pre>
</li>
</ul>
<a name="OS-Traps"></a><h2>OS Traps</h2>
<ul>
<li><a name="*-SysV-resets-signal-handler-correctly"></a><b>SysV resets signal handler correctly</b>
<p>Under HPUX, and some other SysV OSes, one had to reset any signal handler,
within  the signal handler function, each time a signal was handled with
perl4.  With perl5, the reset is now done correctly.  Any code relying
on the handler _not_ being reset will have to be reworked.</p>
<p>Since version 5.002, Perl uses sigaction() under SysV.</p>
<pre class="verbatim"><a name="gotit"></a>    sub <span class="m">gotit</span> <span class="s">{</span>
        <a class="l_k" href="functions/print.html">print</a> <span class="q">&quot;Got @_... &quot;</span><span class="sc">;</span>
    <span class="s">}</span>
    <span class="i">$SIG</span>{<span class="q">&#39;INT&#39;</span>} = <span class="q">&#39;gotit&#39;</span><span class="sc">;</span></pre>
<pre class="verbatim">    <span class="i">$|</span> = <span class="n">1</span><span class="sc">;</span>
    <span class="i">$pid</span> = <a class="l_k" href="functions/fork.html">fork</a><span class="sc">;</span>
    if <span class="s">(</span><span class="i">$pid</span><span class="s">)</span> <span class="s">{</span>
        <a class="l_k" href="functions/kill.html">kill</a><span class="s">(</span><span class="q">&#39;INT&#39;</span><span class="cm">,</span> <span class="i">$pid</span><span class="s">)</span><span class="sc">;</span>
        <a class="l_k" href="functions/sleep.html">sleep</a><span class="s">(</span><span class="n">1</span><span class="s">)</span><span class="sc">;</span>
        <a class="l_k" href="functions/kill.html">kill</a><span class="s">(</span><span class="q">&#39;INT&#39;</span><span class="cm">,</span> <span class="i">$pid</span><span class="s">)</span><span class="sc">;</span>
    <span class="s">}</span> else <span class="s">{</span>
        while <span class="s">(</span><span class="n">1</span><span class="s">)</span> <span class="s">{</span><a class="l_k" href="functions/sleep.html">sleep</a><span class="s">(</span><span class="n">10</span><span class="s">)</span><span class="sc">;</span><span class="s">}</span>
    <span class="s">}</span></pre>
<pre class="verbatim">    <span class="c"># perl4 (HPUX) prints: Got INT...</span>
    <span class="c"># perl5 (HPUX) prints: Got INT... Got INT...</span></pre>
</li>
<li><a name="*-SysV-'seek()'-appends-correctly"></a><b>SysV <code class="inline"><a class="l_k" href="functions/seek.html">seek()</a></code> appends correctly</b>
<p>Under SysV OSes, <code class="inline"><a class="l_k" href="functions/seek.html">seek()</a></code> on a file opened to append <code class="inline">&gt;&gt;</code>
 now does
the right thing w.r.t. the fopen() manpage. e.g., - When a file is opened
for append,  it  is  impossible to overwrite information already in
the file.</p>
<pre class="verbatim">    <a class="l_k" href="functions/open.html">open</a><span class="s">(</span>TEST<span class="cm">,</span><span class="q">&quot;&gt;&gt;seek.test&quot;</span><span class="s">)</span><span class="sc">;</span>
    <span class="i">$start</span> = <a class="l_k" href="functions/tell.html">tell</a> TEST<span class="sc">;</span>
    foreach<span class="s">(</span><span class="n">1</span> .. <span class="n">9</span><span class="s">)</span><span class="s">{</span>
        <a class="l_k" href="functions/print.html">print</a> <span class="i">TEST</span> <span class="q">&quot;$_ &quot;</span><span class="sc">;</span>
    <span class="s">}</span>
    <span class="i">$end</span> = <a class="l_k" href="functions/tell.html">tell</a> TEST<span class="sc">;</span>
    <a class="l_k" href="functions/seek.html">seek</a><span class="s">(</span>TEST<span class="cm">,</span><span class="i">$start</span><span class="cm">,</span><span class="n">0</span><span class="s">)</span><span class="sc">;</span>
    <a class="l_k" href="functions/print.html">print</a> <span class="i">TEST</span> <span class="q">&quot;18 characters here&quot;</span><span class="sc">;</span></pre>
<pre class="verbatim">    <span class="c"># perl4 (solaris) seek.test has: 18 characters here</span>
    <span class="c"># perl5 (solaris) seek.test has: 1 2 3 4 5 6 7 8 9 18 characters here</span></pre>
</li>
</ul>
<a name="Interpolation-Traps"></a><h2>Interpolation Traps</h2>
<p>Perl4-to-Perl5 traps having to do with how things get interpolated
within certain expressions, statements, contexts, or whatever.</p>
<ul>
<li><a name="*-'%40'-always-interpolates-an-array-in-double-quotish-strings"></a><b><code class="inline"><span class="i">@</span></code>
 always interpolates an array in double-quotish strings</b>
<p>@ now always interpolates an array in double-quotish strings.</p>
<pre class="verbatim">    <a class="l_k" href="functions/print.html">print</a> <span class="q">&quot;To: someone@somewhere.com\n&quot;</span><span class="sc">;</span></pre>
<pre class="verbatim">    <span class="c"># perl4 prints: To:someone@somewhere.com</span>
    <span class="c"># perl &lt; 5.6.1, error : In string, @somewhere now must be written as \@somewhere</span>
    <span class="c"># perl &gt;= 5.6.1, warning : Possible unintended interpolation of @somewhere in string</span></pre>
</li>
<li><a name="*-Double-quoted-strings-may-no-longer-end-with-an-unescaped-%24"></a><b>Double-quoted strings may no longer end with an unescaped $</b>
<p>Double-quoted strings may no longer end with an unescaped $.</p>
<pre class="verbatim">    <span class="i">$foo</span> = <span class="q">&quot;foo$&quot;</span><span class="sc">;</span>
    <a class="l_k" href="functions/print.html">print</a> <span class="q">&quot;foo is $foo\n&quot;</span><span class="sc">;</span></pre>
<pre class="verbatim">    <span class="c"># perl4 prints: foo is foo$</span>
    <span class="c"># perl5 errors: Final $ should be \$ or $name</span></pre>
<p>Note: perl5 DOES NOT error on the terminating @ in $bar</p>
</li>
<li><a name="*-Arbitrary-expressions-are-evaluated-inside-braces-within-double-quotes"></a><b>Arbitrary expressions are evaluated inside braces within double quotes</b>
<p>Perl now sometimes evaluates arbitrary expressions inside braces that occur
within double quotes (usually when the opening brace is preceded by <code class="inline"><span class="i">$</span></code>

or <code class="inline"><span class="i">@</span></code>
).</p>
<pre class="verbatim">    <span class="i">@www</span> = <span class="q">&quot;buz&quot;</span><span class="sc">;</span>
    <span class="i">$foo</span> = <span class="q">&quot;foo&quot;</span><span class="sc">;</span>
    <span class="i">$bar</span> = <span class="q">&quot;bar&quot;</span><span class="sc">;</span>
<a name="foo"></a>    sub <span class="m">foo</span> <span class="s">{</span> <a class="l_k" href="functions/return.html">return</a> <span class="q">&quot;bar&quot;</span> <span class="s">}</span><span class="sc">;</span>
    <a class="l_k" href="functions/print.html">print</a> <span class="q">&quot;|@{w.w.w}|${main&#39;foo}|&quot;</span><span class="sc">;</span></pre>
<pre class="verbatim">    <span class="c"># perl4 prints: |@{w.w.w}|foo|</span>
    <span class="c"># perl5 prints: |buz|bar|</span></pre>
<p>Note that you can <code class="inline"><a class="l_k" href="functions/use.html">use</a> <a class="l_w" href="strict.html">strict</a><span class="sc">;</span></code>
 to ward off such trappiness under perl5.</p>
</li>
<li><a name="*-'%24%24x'-now-tries-to-dereference-%24x"></a><b><code class="inline"><span class="i">$$x</span></code>
 now tries to dereference $x</b>
<p>The construct "this is $$x" used to interpolate the pid at that point, but
now tries to dereference $x.  <code class="inline"><span class="i">$$</span></code>
 by itself still works fine, however.</p>
<pre class="verbatim">    <span class="i">$s</span> = <span class="q">&quot;a reference&quot;</span><span class="sc">;</span>
    <span class="i">$x</span> = <span class="i">*s</span><span class="sc">;</span>
    <a class="l_k" href="functions/print.html">print</a> <span class="q">&quot;this is $$x\n&quot;</span><span class="sc">;</span></pre>
<pre class="verbatim">    <span class="c"># perl4 prints: this is XXXx   (XXX is the current pid)</span>
    <span class="c"># perl5 prints: this is a reference</span></pre>
</li>
<li><a name="*-Creation-of-hashes-on-the-fly-with-'eval-%22EXPR%22'-requires-protection"></a><b>Creation of hashes on the fly with <code class="inline"><a class="l_k" href="functions/eval.html">eval</a> <span class="q">&quot;EXPR&quot;</span></code>
 requires protection</b>
<p>Creation of hashes on the fly with <code class="inline"><a class="l_k" href="functions/eval.html">eval</a> <span class="q">&quot;EXPR&quot;</span></code>
 now requires either both
<code class="inline"><span class="i">$</span></code>
's to be protected in the specification of the hash name, or both curlies
to be protected.  If both curlies are protected, the result will be compatible
with perl4 and perl5.  This is a very common practice, and should be changed
to use the block form of <code class="inline"><a class="l_k" href="functions/eval.html">eval{}</a></code>  if possible.</p>
<pre class="verbatim">    <span class="i">$hashname</span> = <span class="q">&quot;foobar&quot;</span><span class="sc">;</span>
    <span class="i">$key</span> = <span class="q">&quot;baz&quot;</span><span class="sc">;</span>
    <span class="i">$value</span> = <span class="n">1234</span><span class="sc">;</span>
    <a class="l_k" href="functions/eval.html">eval</a> <span class="q">&quot;\$$hashname{&#39;$key&#39;} = q|$value|&quot;</span><span class="sc">;</span>
    <span class="s">(</span><a class="l_k" href="functions/defined.html">defined</a><span class="s">(</span><span class="i">$foobar</span>{<span class="q">&#39;baz&#39;</span>}<span class="s">)</span><span class="s">)</span> ?  <span class="s">(</span><a class="l_k" href="functions/print.html">print</a> <span class="q">&quot;Yup&quot;</span><span class="s">)</span> <span class="co">:</span> <span class="s">(</span><a class="l_k" href="functions/print.html">print</a> <span class="q">&quot;Nope&quot;</span><span class="s">)</span><span class="sc">;</span></pre>
<pre class="verbatim">    <span class="c"># perl4 prints: Yup</span>
    <span class="c"># perl5 prints: Nope</span></pre>
<p>Changing</p>
<pre class="verbatim">    <a class="l_k" href="functions/eval.html">eval</a> <span class="q">&quot;\$$hashname{&#39;$key&#39;} = q|$value|&quot;</span><span class="sc">;</span></pre>
<p>to</p>
<pre class="verbatim">    <a class="l_k" href="functions/eval.html">eval</a> <span class="q">&quot;\$\$hashname{&#39;$key&#39;} = q|$value|&quot;</span><span class="sc">;</span></pre>
<p>causes the following result:</p>
<pre class="verbatim">    <span class="c"># perl4 prints: Nope</span>
    <span class="c"># perl5 prints: Yup</span></pre>
<p>or, changing to</p>
<pre class="verbatim">    <a class="l_k" href="functions/eval.html">eval</a> <span class="q">&quot;\$$hashname\{&#39;$key&#39;\} = q|$value|&quot;</span><span class="sc">;</span></pre>
<p>causes the following result:</p>
<pre class="verbatim">    <span class="c"># perl4 prints: Yup</span>
    <span class="c"># perl5 prints: Yup</span>
    <span class="c"># and is compatible for both versions</span></pre>
</li>
<li><a name="*-Bugs-in-earlier-perl-versions"></a><b>Bugs in earlier perl versions</b>
<p>perl4 programs which unconsciously rely on the bugs in earlier perl versions.</p>
<pre class="verbatim">    perl -e <span class="q">&#39;$bar=q/not/; print &quot;This is $foo{$bar} perl5&quot;&#39;</span></pre>
<pre class="verbatim">    <span class="c"># perl4 prints: This is not perl5</span>
    <span class="c"># perl5 prints: This is perl5</span></pre>
</li>
<li><a name="*-Array-and-hash-brackets-during-interpolation"></a><b>Array and hash brackets during interpolation</b>
<p>You also have to be careful about array and hash brackets during
interpolation.</p>
<pre class="verbatim">    <a class="l_k" href="functions/print.html">print</a> <span class="q">&quot;$foo[&quot;</span></pre>
<pre class="verbatim">    perl 4 prints: [
    perl 5 prints: syntax error</pre><pre class="verbatim">    <a class="l_k" href="functions/print.html">print</a> <span class="q">&quot;$foo{&quot;</span></pre>
<pre class="verbatim">    perl 4 prints: {
    perl 5 prints: syntax error</pre><p>Perl 5 is expecting to find an index or key name following the respective
brackets, as well as an ending bracket of the appropriate type.  In order
to mimic the behavior of Perl 4, you must escape the bracket like so.</p>
<pre class="verbatim">    <a class="l_k" href="functions/print.html">print</a> <span class="q">&quot;$foo\[&quot;</span><span class="sc">;</span>
    <a class="l_k" href="functions/print.html">print</a> <span class="q">&quot;$foo\{&quot;</span><span class="sc">;</span></pre>
</li>
<li><a name="*-Interpolation-of-'%5c%24%24foo%7bbar%7d'"></a><b>Interpolation of <code class="inline">\<span class="i">$$foo</span>{bar}</code>
</b>
<p>Similarly, watch out for: <code class="inline">\<span class="i">$$foo</span>{bar}</code>
</p>
<pre class="verbatim">    <span class="i">$foo</span> = <span class="q">&quot;baz&quot;</span><span class="sc">;</span>
    <a class="l_k" href="functions/print.html">print</a> <span class="q">&quot;\$$foo{bar}\n&quot;</span><span class="sc">;</span></pre>
<pre class="verbatim">    <span class="c"># perl4 prints: $baz{bar}</span>
    <span class="c"># perl5 prints: $</span></pre>
<p>Perl 5 is looking for <code class="inline"><span class="i">$foo</span>{bar}</code>
 which doesn't exist, but perl 4 is
happy just to expand $foo to "baz" by itself.  Watch out for this
especially in <code class="inline"><a class="l_k" href="functions/eval.html">eval</a></code>'s.</p>
</li>
<li><a name="*-'qq()'-string-passed-to-'eval'-will-not-find-string-terminator"></a><b><code class="inline"><a class="l_k" href="functions/qq.html">qq()</a></code> string passed to <code class="inline"><a class="l_k" href="functions/eval.html">eval</a></code> will not find string terminator</b>
<p><code class="inline"><a class="l_k" href="functions/qq.html">qq()</a></code> string passed to <code class="inline"><a class="l_k" href="functions/eval.html">eval</a></code></p>
<pre class="verbatim">    eval qq(
        foreach \$y (keys %\$x\) {
            \$count++;
        }
    );</pre><pre class="verbatim">    <span class="c"># perl4 runs this ok</span>
    <span class="c"># perl5 prints: Can&#39;t find string terminator &quot;)&quot;</span></pre>
</li>
</ul>
<a name="DBM-Traps"></a><h2>DBM Traps</h2>
<p>General DBM traps.</p>
<ul>
<li><a name="*-Perl5-must-have-been-linked-with-same-dbm%2fndbm-as-the-default-for-'dbmopen()'"></a><b>Perl5 must have been linked with same dbm/ndbm as the default for <code class="inline"><a class="l_k" href="functions/dbmopen.html">dbmopen()</a></code></b>
<p>Existing dbm databases created under perl4 (or any other dbm/ndbm tool)
may cause the same script, run under perl5, to fail.  The build of perl5
must have been linked with the same dbm/ndbm as the default for <code class="inline"><a class="l_k" href="functions/dbmopen.html">dbmopen()</a></code>
to function properly without <code class="inline"><a class="l_k" href="functions/tie.html">tie</a></code>'ing to an extension dbm implementation.</p>
<pre class="verbatim">    <a class="l_k" href="functions/dbmopen.html">dbmopen</a> <span class="s">(</span><span class="i">%dbm</span><span class="cm">,</span> <span class="q">&quot;file&quot;</span><span class="cm">,</span> <a class="l_k" href="functions/undef.html">undef</a><span class="s">)</span><span class="sc">;</span>
    <a class="l_k" href="functions/print.html">print</a> <span class="q">&quot;ok\n&quot;</span><span class="sc">;</span></pre>
<pre class="verbatim">    <span class="c"># perl4 prints: ok</span>
    <span class="c"># perl5 prints: ok (IFF linked with -ldbm or -lndbm)</span></pre>
</li>
<li><a name="*-DBM-exceeding-limit-on-the-key%2fvalue-size-will-cause-perl5-to-exit-immediately"></a><b>DBM exceeding limit on the key/value size will cause perl5 to exit immediately</b>
<p>Existing dbm databases created under perl4 (or any other dbm/ndbm tool)
may cause the same script, run under perl5, to fail.  The error generated
when exceeding the limit on the key/value size will cause perl5 to exit
immediately.</p>
<pre class="verbatim">    <a class="l_k" href="functions/dbmopen.html">dbmopen</a><span class="s">(</span><a class="l_w" href="DB.html">DB</a><span class="cm">,</span> <span class="q">&quot;testdb&quot;</span><span class="cm">,</span><span class="n">0600</span><span class="s">)</span> || <a class="l_k" href="functions/die.html">die</a> <span class="q">&quot;couldn&#39;t open db! $!&quot;</span><span class="sc">;</span>
    <span class="i">$DB</span>{<span class="q">&#39;trap&#39;</span>} = <span class="q">&quot;x&quot;</span> x <span class="n">1024</span><span class="sc">;</span>  <span class="c"># value too large for most dbm/ndbm</span>
    <a class="l_k" href="functions/print.html">print</a> <span class="q">&quot;YUP\n&quot;</span><span class="sc">;</span></pre>
<pre class="verbatim">    # perl4 prints:
    dbm store returned -1, errno 28, key "trap" at - line 3.
    YUP</pre><pre class="verbatim">    # perl5 prints:
    dbm store returned -1, errno 28, key "trap" at - line 3.</pre></li>
</ul>
<a name="Unclassified-Traps"></a><h2>Unclassified Traps</h2>
<p>Everything else.</p>
<ul>
<li><a name="*-'require'%2f'do'-trap-using-returned-value"></a><b><code class="inline"><a class="l_k" href="functions/require.html">require</a></code>/<code class="inline"><a class="l_k" href="functions/do.html">do</a></code> trap using returned value</b>
<p>If the file doit.pl has:</p>
<pre class="verbatim"><a name="foo"></a>    sub <span class="m">foo</span> <span class="s">{</span>
        <span class="i">$rc</span> = <a class="l_k" href="functions/do.html">do</a> <span class="q">&quot;./do.pl&quot;</span><span class="sc">;</span>
        <a class="l_k" href="functions/return.html">return</a> <span class="n">8</span><span class="sc">;</span>
    <span class="s">}</span>
    <a class="l_k" href="functions/print.html">print</a> <span class="i">&amp;foo</span><span class="cm">,</span> <span class="q">&quot;\n&quot;</span><span class="sc">;</span></pre>
<p>And the do.pl file has the following single line:</p>
<pre class="verbatim">    <a class="l_k" href="functions/return.html">return</a> <span class="n">3</span><span class="sc">;</span></pre>
<p>Running doit.pl gives the following:</p>
<pre class="verbatim">    <span class="c"># perl 4 prints: 3 (aborts the subroutine early)</span>
    <span class="c"># perl 5 prints: 8</span></pre>
<p>Same behavior if you replace <code class="inline"><a class="l_k" href="functions/do.html">do</a></code> with <code class="inline"><a class="l_k" href="functions/require.html">require</a></code>.</p>
</li>
<li><a name="*-'split'-on-empty-string-with-LIMIT-specified"></a><b><code class="inline"><a class="l_k" href="functions/split.html">split</a></code> on empty string with LIMIT specified</b>
<pre class="verbatim">    <span class="i">$string</span> = <span class="q">&#39;&#39;</span><span class="sc">;</span>
    <span class="i">@list</span> = <a class="l_k" href="functions/split.html">split</a><span class="s">(</span><span class="q">/foo/</span><span class="cm">,</span> <span class="i">$string</span><span class="cm">,</span> <span class="n">2</span><span class="s">)</span></pre>
<p>Perl4 returns a one element list containing the empty string but Perl5
returns an empty list.</p>
</li>
</ul>
<p>As always, if any of these are ever officially declared as bugs,
they'll be fixed and removed.</p>
</div>
      <div id="contentFooter"><a href="http://www.perl.org"><img src="perlpowered.png" border=0></a></div>
    </div>
  </div>

  <div id="right">
    <div id="rightContent">
      <div id="leftClose">
        <a href="#" onClick="closeRight()" title="Hide toolbar" onmouseover="rightCloseIcon.src='close_purple.gif';" onmouseout="rightCloseIcon.src='close_blue.gif';"><img src="close_blue.gif" name="rightCloseIcon" id="rightCloseIcon" border=0></a>
      </div>
      <h1>Search:</h1>
      <p>
        <form action="search.html" name="perldoc_search">
	  <input type="text" name="q" size="10" class="grey"><br>
	  <!--<select name="r"><option value="1" selected>Go to top result<option value="0">Show results list</select>-->
	</form>
      </p>
      <h2>Labels:</h2>
      <p>
        <a href="#" onClick="addLabel('perltrap','perltrap.html')">Add this page</a>
      </p>
      <div class="labels" id="labels">
      </div>
    </div>
  </div>

</div>

</body>
</html>
